<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lab 6 Night Time Lights Appendix | Remote Sensing in the Social Sciences</title>
  <meta name="description" content="Lab 6 Night Time Lights Appendix | Remote Sensing in the Social Sciences" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Lab 6 Night Time Lights Appendix | Remote Sensing in the Social Sciences" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab 6 Night Time Lights Appendix | Remote Sensing in the Social Sciences" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lab5.html"/>

<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html"><i class="fa fa-check"></i>PreLab: Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#overview"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="0.1" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#data-and-methods"><i class="fa fa-check"></i><b>0.1</b> Data and Methods</a></li>
<li class="chapter" data-level="0.2" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#images-and-image-collections"><i class="fa fa-check"></i><b>0.2</b> Images and Image Collections</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#images"><i class="fa fa-check"></i><b>0.2.1</b> Images</a></li>
<li class="chapter" data-level="0.2.2" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#image-collections"><i class="fa fa-check"></i><b>0.2.2</b> Image Collections</a></li>
<li class="chapter" data-level="0.2.3" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#sensed-versus-derived-imagery"><i class="fa fa-check"></i><b>0.2.3</b> Sensed versus Derived Imagery</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#geometries"><i class="fa fa-check"></i><b>0.3</b> Geometries</a></li>
<li class="chapter" data-level="0.4" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#features-and-feature-collections"><i class="fa fa-check"></i><b>0.4</b> Features and Feature Collections</a>
<ul>
<li class="chapter" data-level="0.4.1" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#features"><i class="fa fa-check"></i><b>0.4.1</b> Features</a></li>
<li class="chapter" data-level="0.4.2" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#feature-collections"><i class="fa fa-check"></i><b>0.4.2</b> Feature Collections</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#methods-reducers"><i class="fa fa-check"></i><b>0.5</b> Methods: Reducers</a></li>
<li class="chapter" data-level="0.6" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#joins-and-arrays"><i class="fa fa-check"></i><b>0.6</b> Joins and Arrays</a>
<ul>
<li class="chapter" data-level="0.6.1" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#join"><i class="fa fa-check"></i><b>0.6.1</b> Join</a></li>
<li class="chapter" data-level="0.6.2" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#arrays"><i class="fa fa-check"></i><b>0.6.2</b> Arrays</a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#additional-resources"><i class="fa fa-check"></i><b>0.7</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="lab1.html"><a href="lab1.html"><i class="fa fa-check"></i><b>1</b> Remote Sensing Background</a>
<ul>
<li class="chapter" data-level="" data-path="lab1.html"><a href="lab1.html#overview-1"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1.1" data-path="lab1.html"><a href="lab1.html#what-is-a-digital-image"><i class="fa fa-check"></i><b>1.1</b> What is a digital image?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="lab1.html"><a href="lab1.html#from-digital-image-to-geospatial-image"><i class="fa fa-check"></i><b>1.1.1</b> From digital image to geospatial image</a></li>
<li class="chapter" data-level="1.1.2" data-path="lab1.html"><a href="lab1.html#visualize-a-digital-image"><i class="fa fa-check"></i><b>1.1.2</b> Visualize a Digital Image</a></li>
<li class="chapter" data-level="1.1.3" data-path="lab1.html"><a href="lab1.html#digital-image-visualization-and-stretching"><i class="fa fa-check"></i><b>1.1.3</b> Digital Image Visualization and Stretching</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="lab1.html"><a href="lab1.html#spatial-resolution"><i class="fa fa-check"></i><b>1.2</b> Spatial Resolution</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="lab1.html"><a href="lab1.html#modis"><i class="fa fa-check"></i><b>1.2.1</b> MODIS</a></li>
<li class="chapter" data-level="1.2.2" data-path="lab1.html"><a href="lab1.html#multispectral-scanners"><i class="fa fa-check"></i><b>1.2.2</b> Multispectral Scanners</a></li>
<li class="chapter" data-level="1.2.3" data-path="lab1.html"><a href="lab1.html#thematic-mapper-tm"><i class="fa fa-check"></i><b>1.2.3</b> Thematic Mapper (TM)</a></li>
<li class="chapter" data-level="1.2.4" data-path="lab1.html"><a href="lab1.html#national-agriculture-imagery-program-naip"><i class="fa fa-check"></i><b>1.2.4</b> National Agriculture Imagery Program (NAIP)</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="lab1.html"><a href="lab1.html#spectral-resolution"><i class="fa fa-check"></i><b>1.3</b> Spectral Resolution</a></li>
<li class="chapter" data-level="1.4" data-path="lab1.html"><a href="lab1.html#temporal-resolution"><i class="fa fa-check"></i><b>1.4</b> Temporal Resolution</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="lab1.html"><a href="lab1.html#modis-1"><i class="fa fa-check"></i><b>1.4.1</b> MODIS</a></li>
<li class="chapter" data-level="1.4.2" data-path="lab1.html"><a href="lab1.html#landsat"><i class="fa fa-check"></i><b>1.4.2</b> Landsat</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="lab1.html"><a href="lab1.html#radiometric-resolution"><i class="fa fa-check"></i><b>1.5</b> Radiometric Resolution</a></li>
<li class="chapter" data-level="1.6" data-path="lab1.html"><a href="lab1.html#resampling-and-reprojection"><i class="fa fa-check"></i><b>1.6</b> Resampling and ReProjection</a></li>
<li class="chapter" data-level="1.7" data-path="lab1.html"><a href="lab1.html#additional-exercises"><i class="fa fa-check"></i><b>1.7</b> Additional Exercises</a></li>
<li class="chapter" data-level="" data-path="lab1.html"><a href="lab1.html#where-to-submit"><i class="fa fa-check"></i>Where to submit</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lab2.html"><a href="lab2.html"><i class="fa fa-check"></i><b>2</b> Digital Imagery &amp; Image Processing</a>
<ul>
<li class="chapter" data-level="" data-path="lab2.html"><a href="lab2.html#overview-2"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="2.1" data-path="lab2.html"><a href="lab2.html#searching-for-imagery-exercise-1"><i class="fa fa-check"></i><b>2.1</b> Searching for Imagery (Exercise 1)</a></li>
<li class="chapter" data-level="2.2" data-path="lab2.html"><a href="lab2.html#visualizing-landsat-imagery"><i class="fa fa-check"></i><b>2.2</b> Visualizing Landsat Imagery</a></li>
<li class="chapter" data-level="2.3" data-path="lab2.html"><a href="lab2.html#plot-at-sensor-radiance"><i class="fa fa-check"></i><b>2.3</b> Plot at-Sensor Radiance</a></li>
<li class="chapter" data-level="2.4" data-path="lab2.html"><a href="lab2.html#plot-top-of-atmosphere-toa-reflectance"><i class="fa fa-check"></i><b>2.4</b> Plot Top-of-Atmosphere (TOA) Reflectance</a></li>
<li class="chapter" data-level="2.5" data-path="lab2.html"><a href="lab2.html#plot-surface-reflectance"><i class="fa fa-check"></i><b>2.5</b> Plot Surface Reflectance</a></li>
<li class="chapter" data-level="2.6" data-path="lab2.html"><a href="lab2.html#additional-exercises-1"><i class="fa fa-check"></i><b>2.6</b> Additional Exercises</a></li>
<li class="chapter" data-level="" data-path="lab2.html"><a href="lab2.html#where-to-submit-1"><i class="fa fa-check"></i>Where to submit</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html"><i class="fa fa-check"></i><b>3</b> Spectral Indices &amp; Transformations</a>
<ul>
<li class="chapter" data-level="" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#overview-3"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="3.1" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#spectral-indices"><i class="fa fa-check"></i><b>3.1</b> Spectral Indices</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#important-indices"><i class="fa fa-check"></i><b>3.1.1</b> Important Indices</a></li>
<li class="chapter" data-level="3.1.2" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#linear-transformations"><i class="fa fa-check"></i><b>3.1.2</b> Linear Transformations</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#spectral-transformation"><i class="fa fa-check"></i><b>3.2</b> Spectral Transformation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#linear-filtering"><i class="fa fa-check"></i><b>3.2.1</b> Linear Filtering</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#additional-exercises-2"><i class="fa fa-check"></i><b>3.3</b> Additional Exercises</a></li>
<li class="chapter" data-level="" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#where-to-submit-2"><i class="fa fa-check"></i>Where to submit</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>4</b> Classification</a>
<ul>
<li class="chapter" data-level="" data-path="classification.html"><a href="classification.html#overview-4"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="4.1" data-path="classification.html"><a href="classification.html#introduction-to-classification"><i class="fa fa-check"></i><b>4.1</b> Introduction to Classification</a></li>
<li class="chapter" data-level="4.2" data-path="classification.html"><a href="classification.html#unsupervised-classification"><i class="fa fa-check"></i><b>4.2</b> Unsupervised Classification</a></li>
<li class="chapter" data-level="4.3" data-path="classification.html"><a href="classification.html#supervised-classification"><i class="fa fa-check"></i><b>4.3</b> Supervised Classification</a></li>
<li class="chapter" data-level="4.4" data-path="classification.html"><a href="classification.html#accuracy-assessment"><i class="fa fa-check"></i><b>4.4</b> Accuracy Assessment</a></li>
<li class="chapter" data-level="4.5" data-path="classification.html"><a href="classification.html#hyperparameter-tuning"><i class="fa fa-check"></i><b>4.5</b> Hyperparameter Tuning</a></li>
<li class="chapter" data-level="4.6" data-path="classification.html"><a href="classification.html#assignment"><i class="fa fa-check"></i><b>4.6</b> Assignment</a></li>
<li class="chapter" data-level="" data-path="classification.html"><a href="classification.html#where-to-submit-3"><i class="fa fa-check"></i>Where to submit</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lab5.html"><a href="lab5.html"><i class="fa fa-check"></i><b>5</b> Time Series Modeling</a>
<ul>
<li class="chapter" data-level="" data-path="lab5.html"><a href="lab5.html#overview-5"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="5.1" data-path="lab5.html"><a href="lab5.html#background"><i class="fa fa-check"></i><b>5.1</b> Background</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="lab5.html"><a href="lab5.html#im_06_07"><i class="fa fa-check"></i><b>5.1.1</b> <img src="im/im_06_01.png" alt="im_06_07" /></a></li>
<li class="chapter" data-level="5.1.2" data-path="lab5.html"><a href="lab5.html#limitations-in-remote-sensing-time-series"><i class="fa fa-check"></i><b>5.1.2</b> Limitations in Remote Sensing Time Series</a></li>
<li class="chapter" data-level="5.1.3" data-path="lab5.html"><a href="lab5.html#multi-temporal-data-in-earth-engine"><i class="fa fa-check"></i><b>5.1.3</b> Multi-Temporal Data in Earth Engine</a></li>
<li class="chapter" data-level="5.1.4" data-path="lab5.html"><a href="lab5.html#data-preparation-and-preprocessing"><i class="fa fa-check"></i><b>5.1.4</b> Data Preparation and Preprocessing</a></li>
<li class="chapter" data-level="5.1.5" data-path="lab5.html"><a href="lab5.html#linear-modeling-of-time"><i class="fa fa-check"></i><b>5.1.5</b> Linear Modeling of Time</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="lab5.html"><a href="lab5.html#estimate-seasonality-with-a-harmonic-model"><i class="fa fa-check"></i><b>5.2</b> Estimate Seasonality with a Harmonic Model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="lab5.html"><a href="lab5.html#complex-time-series-modeling"><i class="fa fa-check"></i><b>5.2.1</b> Complex Time Series Modeling</a></li>
<li class="chapter" data-level="5.2.2" data-path="lab5.html"><a href="lab5.html#exporting-data"><i class="fa fa-check"></i><b>5.2.2</b> Exporting Data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lab5.html"><a href="lab5.html#time-series-thresholding"><i class="fa fa-check"></i><b>5.3</b> Time Series Thresholding</a></li>
<li class="chapter" data-level="5.4" data-path="lab5.html"><a href="lab5.html#additional-exercises-3"><i class="fa fa-check"></i><b>5.4</b> Additional Exercises</a></li>
<li class="chapter" data-level="" data-path="lab5.html"><a href="lab5.html#where-to-submit-4"><i class="fa fa-check"></i>Where to submit</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lab6.html"><a href="lab6.html"><i class="fa fa-check"></i><b>6</b> Night Time Lights Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="lab6.html"><a href="lab6.html#overview-6"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="6.1" data-path="lab6.html"><a href="lab6.html#basic-operations"><i class="fa fa-check"></i><b>6.1</b> Basic Operations</a></li>
<li class="chapter" data-level="6.2" data-path="lab6.html"><a href="lab6.html#conclusion"><i class="fa fa-check"></i><b>6.2</b> Conclusion</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/benamie/remote-sense-social/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Remote Sensing in the Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lab6" class="section level1" number="6">
<h1><span class="header-section-number">Lab 6</span> Night Time Lights Appendix</h1>
<div id="overview-6" class="section level2 unnumbered">
<h2>Overview</h2>
<p>Capturing and visualizing low-light emittance from around the earth has been utilized in various applications since the mid-1960’s. By consistently quantifying light emittance over long time periods, it is possible to use this as a proxy for economic development, especially in areas where there is not high-quality data and metrics to work with. Google Earth Engine has consolidated this data into an operational archive dating back to 1992, which is an excellent way to find meaningful insights using this data set.</p>
<p>This tutorial is a supplement to the excellent <em>Open Nighttime Lights</em> <a href="https://worldbank.github.io/OpenNightLights/welcome.html">tutorial</a> that the World Bank developed. The World Bank tutorial consists of six modules, including a background on the history of the data, working with the tools, extracting imagery, data analysis and image classification. It also contains an archive in which you can archive the raw data directly from Amazon Web Services and an applications section that attempts to estimate electricity usage using the nighttime data set. Each segment is well-written, and there is extensive documentation throughout.</p>
<p>The caveat here is that up until this point in the course, we have worked with the Google Earth Engine JavaScript code editor - Because the World Bank tutorial covers topics such as working with data frames, statistics and classification, it utilizes the Google Earth Engine Python API in a Jupyter Notebook. Python is a more natural fit and contains more capabilities for data analysis and Machine Learning than JavaScript, and while the GEE code editor is excellent at working with objects and methods, many of you might prefer working with Python. Based on your background and what you want to get out of this course, here is our general suggestion on how to proceed.</p>
<ol style="list-style-type: decimal">
<li>If you are comfortable working with Python, Jupyter Notebooks and setting up your own environment (pip, Conda, Brew), than follow along with the tutorial as it is. Module 2-2 in the World Bank tutorial explains how to get an environment up and running.
<ol style="list-style-type: decimal">
<li>If this is the case, spend some time reading about the functionality in the <a href="https://geemap.org">geemap</a> package - it consolidates much of the mapping features in Earth Engine in an intuitive way, as well as functionality to integrate your results with Folium and custom basemaps.</li>
</ol></li>
<li>If you want to learn to use Python but have never worked with virtual environments, then consider going through the tutorial in a Google Colab - it requires no setup of infrastructure, and you can get running immediately while learning Python. Once you are comfortable with this, you can always learn how to set up your own environment. Explanations on getting started can be located <a href="https://worldbank.github.io/OpenNightLights/tutorials/mod2_3_introduction_to_Jupyter_notebooks.html">here</a>. Note that there are several components of the tutorial, primarily in visualization using leaflet, that will not work.</li>
<li>If you want to stick with working with JavaScript, then the section below will provide you with some capabilities of doing the core functions in the code editor, mainly the segment in Module 3. After that, we suggest exporting the data for further analysis.</li>
</ol>
<p>Again, this lab is more of a supplement for students that wish to keep using JavaScript and the GEE code editor. It is not designed to fully replace the World Bank tutorial, and while will get you started, there will be things that you will have to figure out on your own.</p>
</div>
<div id="basic-operations" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Basic Operations</h2>
<p>Module 1 is an essential introduction to the NightTime Lights dataset, while Module 2 introduces you to the data and the setting up your environment. In this section, we will covering the essential components of obtaining the data that you need in the correct context, some basic processing, building a composite and exporting the data in JavaScript, with enough code to show you how to get started and how to follow along with the tutorial.</p>
<p>We will follow along with module exactly as it is set up, so that you can refer to the Module and section numbers.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Obtaining the Data</strong></p>
<p>The code chunk below should be a good starting point on ingesting the data, looking at the range of data, and visualizing the average value across the image collection. Follow along with the same concepts in the tutorial, test using a specific image (instead of an image collection) and visualize your results. You can modify the opacity manually using the slider on the <code>layers</code> tab, and then build it into your <a href="https://developers.google.com/earth-engine/guides/image_visualization?hl=en#code-editor-javascript">visualization</a>.</p>
<p>Note: JavaScript uses Lon / Lat, while Python uses lat / long while building points or setting map areas.</p></li>
</ol>
<div class="sourceCode" id="cb105"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb105-1"><a href="lab6.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Read in Nighttime Lights</span></span>
<span id="cb105-2"><a href="lab6.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> dmsp <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;NOAA/DMSP-OLS/NIGHTTIME_LIGHTS&quot;</span>)<span class="op">;</span></span>
<span id="cb105-3"><a href="lab6.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Print size of the image collection</span></span>
<span id="cb105-4"><a href="lab6.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dmsp<span class="op">.</span><span class="fu">size</span>())<span class="op">;</span></span>
<span id="cb105-5"><a href="lab6.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Print out the dates of image collection</span></span>
<span id="cb105-6"><a href="lab6.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imgrange <span class="op">=</span> dmsp<span class="op">.</span><span class="fu">reduceColumns</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">minMax</span>()<span class="op">,</span> [<span class="st">&quot;system:time_start&quot;</span>])<span class="op">;</span></span>
<span id="cb105-7"><a href="lab6.html#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> start <span class="op">=</span> ee<span class="op">.</span><span class="fu">Date</span>(imgrange<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;min&#39;</span>))<span class="op">;</span></span>
<span id="cb105-8"><a href="lab6.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> end <span class="op">=</span> ee<span class="op">.</span><span class="fu">Date</span>(imgrange<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;max&#39;</span>))<span class="op">;</span></span>
<span id="cb105-9"><a href="lab6.html#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Date range: &#39;</span><span class="op">,</span> start<span class="op">,</span> end)<span class="op">;</span></span>
<span id="cb105-10"><a href="lab6.html#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co">// Take average visibility </span></span>
<span id="cb105-11"><a href="lab6.html#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nighttimeLights <span class="op">=</span> dmsp<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;avg_vis&#39;</span>)<span class="op">;</span></span>
<span id="cb105-12"><a href="lab6.html#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nighttimeLightsVis <span class="op">=</span> {</span>
<span id="cb105-13"><a href="lab6.html#cb105-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="fl">3.0</span><span class="op">,</span></span>
<span id="cb105-14"><a href="lab6.html#cb105-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="fl">60.0</span><span class="op">,</span></span>
<span id="cb105-15"><a href="lab6.html#cb105-15" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb105-16"><a href="lab6.html#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> center_lat <span class="op">=</span> <span class="fl">38.9072</span><span class="op">;</span></span>
<span id="cb105-17"><a href="lab6.html#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> center_lon <span class="op">=</span> <span class="op">-</span><span class="fl">77.0369</span><span class="op">;</span></span>
<span id="cb105-18"><a href="lab6.html#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> zoomlevel<span class="op">=</span><span class="dv">7</span><span class="op">;</span></span>
<span id="cb105-19"><a href="lab6.html#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="co">// </span></span>
<span id="cb105-20"><a href="lab6.html#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setCenter</span>(center_lon<span class="op">,</span> center_lat<span class="op">,</span> zoomlevel)<span class="op">;</span></span>
<span id="cb105-21"><a href="lab6.html#cb105-21" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(nighttimeLights<span class="op">,</span> nighttimeLightsVis<span class="op">,</span> <span class="st">&#39;Nighttime Lights&#39;</span>)<span class="op">;</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p><strong>Image Clipping</strong></p>
<p>This section follows along with some of our earlier work in clipping our image to a certain area. Whether you need to bring in your own shapefiles. The code below clips a single around a 200km buffer around Los Angeles.</p></li>
</ol>
<div class="sourceCode" id="cb106"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb106-1"><a href="lab6.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Get December image - &quot;avg_rad&quot; band</span></span>
<span id="cb106-2"><a href="lab6.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> viirs2019_12 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;NOAA/VIIRS/DNB/MONTHLY_V1/VCMSLCFG&quot;</span>)<span class="op">.</span><span class="fu">filterDate</span>(</span>
<span id="cb106-3"><a href="lab6.html#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2019-12-01&quot;</span><span class="op">,</span><span class="st">&quot;2019-12-31&quot;</span>)<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;avg_rad&#39;</span>)<span class="op">.</span><span class="fu">median</span>()</span>
<span id="cb106-4"><a href="lab6.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Set visibility parameters</span></span>
<span id="cb106-5"><a href="lab6.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nighttimeLightsVis <span class="op">=</span> {</span>
<span id="cb106-6"><a href="lab6.html#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="fl">3.0</span><span class="op">,</span></span>
<span id="cb106-7"><a href="lab6.html#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="fl">60.0</span><span class="op">,</span></span>
<span id="cb106-8"><a href="lab6.html#cb106-8" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb106-9"><a href="lab6.html#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> center_lat <span class="op">=</span> <span class="fl">34.05</span><span class="op">;</span></span>
<span id="cb106-10"><a href="lab6.html#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> center_lon <span class="op">=</span> <span class="op">-</span><span class="fl">118.25</span><span class="op">;</span></span>
<span id="cb106-11"><a href="lab6.html#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Build a 200km buffer around a point</span></span>
<span id="cb106-12"><a href="lab6.html#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="co">// Clip image to boundary of buffer</span></span>
<span id="cb106-13"><a href="lab6.html#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> aoi <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>([center_lon<span class="op">,</span> center_lat])<span class="op">.</span><span class="fu">buffer</span>(<span class="dv">200000</span>)<span class="op">;</span></span>
<span id="cb106-14"><a href="lab6.html#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> viirs2019_12_clipped <span class="op">=</span> viirs2019_12<span class="op">.</span><span class="fu">clip</span>(aoi)</span>
<span id="cb106-15"><a href="lab6.html#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> zoomlevel<span class="op">=</span><span class="dv">7</span><span class="op">;</span></span>
<span id="cb106-16"><a href="lab6.html#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="co">// map set center </span></span>
<span id="cb106-17"><a href="lab6.html#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setCenter</span>(center_lon<span class="op">,</span> center_lat<span class="op">,</span> zoomlevel)<span class="op">;</span></span>
<span id="cb106-18"><a href="lab6.html#cb106-18" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(viirs2019_12_clipped<span class="op">,</span> nighttimeLightsVis<span class="op">,</span> <span class="st">&#39;Clipped to Buffer&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="figure">
<img src="im/im_07_01.png" alt="" />
<p class="caption">im_07_01</p>
</div>
<p>You can do the same thing with either your own polygon vector files (import shapefile, kml), or use one of the vector files that GEE maintains - we can test use the TIGER state boundary file and clip the image to California.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb107-1"><a href="lab6.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Get December image - &quot;avg_rad&quot; band</span></span>
<span id="cb107-2"><a href="lab6.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> viirs2019_12 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;NOAA/VIIRS/DNB/MONTHLY_V1/VCMSLCFG&quot;</span>)<span class="op">.</span><span class="fu">filterDate</span>(</span>
<span id="cb107-3"><a href="lab6.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2019-12-01&quot;</span><span class="op">,</span><span class="st">&quot;2019-12-31&quot;</span>)<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;avg_rad&#39;</span>)<span class="op">.</span><span class="fu">median</span>()</span>
<span id="cb107-4"><a href="lab6.html#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Set visibility parameters</span></span>
<span id="cb107-5"><a href="lab6.html#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nighttimeLightsVis <span class="op">=</span> {</span>
<span id="cb107-6"><a href="lab6.html#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="fl">3.0</span><span class="op">,</span></span>
<span id="cb107-7"><a href="lab6.html#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="fl">60.0</span><span class="op">,</span></span>
<span id="cb107-8"><a href="lab6.html#cb107-8" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb107-9"><a href="lab6.html#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> center_lat <span class="op">=</span> <span class="dv">37</span><span class="op">;</span></span>
<span id="cb107-10"><a href="lab6.html#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> center_lon <span class="op">=</span> <span class="op">-</span><span class="dv">120</span><span class="op">;</span></span>
<span id="cb107-11"><a href="lab6.html#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Boundary of states</span></span>
<span id="cb107-12"><a href="lab6.html#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="co">// Filter to California </span></span>
<span id="cb107-13"><a href="lab6.html#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> aoi_CA <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;TIGER/2016/States&#39;</span>)<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb107-14"><a href="lab6.html#cb107-14" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;NAME&#39;</span><span class="op">,</span> <span class="st">&#39;California&#39;</span>))</span>
<span id="cb107-15"><a href="lab6.html#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> viirs2019_12_clipped <span class="op">=</span> viirs2019_12<span class="op">.</span><span class="fu">clip</span>(aoi_CA)</span>
<span id="cb107-16"><a href="lab6.html#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> zoomlevel<span class="op">=</span><span class="dv">6</span><span class="op">;</span></span>
<span id="cb107-17"><a href="lab6.html#cb107-17" aria-hidden="true" tabindex="-1"></a><span class="co">// map set center </span></span>
<span id="cb107-18"><a href="lab6.html#cb107-18" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setCenter</span>(center_lon<span class="op">,</span> center_lat<span class="op">,</span> zoomlevel)<span class="op">;</span></span>
<span id="cb107-19"><a href="lab6.html#cb107-19" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(viirs2019_12_clipped<span class="op">,</span> nighttimeLightsVis<span class="op">,</span> <span class="st">&#39;California NightTime Lights&#39;</span>)<span class="op">;</span> </span></code></pre></div>
<div class="figure">
<img src="im/im_07_02.png" alt="" />
<p class="caption">im_07_02</p>
</div>
<p>The previous two examples showed the process of clipping individual images - to clip an entire image collection and extract a composite image, we can follow the same general approach, but use the <code>map</code> function to clip each image of the collection to our boundary. However, note that depending on the use case and the size of the image collection, this might take time to run and still leave you with a large amount of data. Before exporting all the data, perhaps reduce the image collection by extracting mean / median values, or use the reduce function.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb108-1"><a href="lab6.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> viirsDNB <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;NOAA/VIIRS/DNB/MONTHLY_V1/VCMSLCFG&quot;</span>)<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;avg_rad&#39;</span>)</span>
<span id="cb108-2"><a href="lab6.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Define our clipping function</span></span>
<span id="cb108-3"><a href="lab6.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Built specifically for the purposes of clipping to California</span></span>
<span id="cb108-4"><a href="lab6.html#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">clip_func</span>(im_col) {</span>
<span id="cb108-5"><a href="lab6.html#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> im_col<span class="op">.</span><span class="fu">clip</span>(aoi_CA)<span class="op">;</span></span>
<span id="cb108-6"><a href="lab6.html#cb108-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-7"><a href="lab6.html#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Set visibility parameters</span></span>
<span id="cb108-8"><a href="lab6.html#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nighttimeLightsVis <span class="op">=</span> {</span>
<span id="cb108-9"><a href="lab6.html#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="fl">3.0</span><span class="op">,</span></span>
<span id="cb108-10"><a href="lab6.html#cb108-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="fl">60.0</span><span class="op">,</span></span>
<span id="cb108-11"><a href="lab6.html#cb108-11" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb108-12"><a href="lab6.html#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> center_lat <span class="op">=</span> <span class="dv">37</span><span class="op">;</span></span>
<span id="cb108-13"><a href="lab6.html#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> center_lon <span class="op">=</span> <span class="op">-</span><span class="dv">120</span><span class="op">;</span></span>
<span id="cb108-14"><a href="lab6.html#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> zoomlevel<span class="op">=</span><span class="dv">6</span><span class="op">;</span></span>
<span id="cb108-15"><a href="lab6.html#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="co">// Boundary of States</span></span>
<span id="cb108-16"><a href="lab6.html#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Filter to California </span></span>
<span id="cb108-17"><a href="lab6.html#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> aoi_CA <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;TIGER/2016/States&#39;</span>)<span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb108-18"><a href="lab6.html#cb108-18" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;NAME&#39;</span><span class="op">,</span> <span class="st">&#39;California&#39;</span>))</span>
<span id="cb108-19"><a href="lab6.html#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="co">// use `map` - which applied our function to each image in the image collection</span></span>
<span id="cb108-20"><a href="lab6.html#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> viirs_dmb_clipped <span class="op">=</span> viirsDNB<span class="op">.</span><span class="fu">map</span>(clip_func)</span>
<span id="cb108-21"><a href="lab6.html#cb108-21" aria-hidden="true" tabindex="-1"></a><span class="co">// map set center </span></span>
<span id="cb108-22"><a href="lab6.html#cb108-22" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setCenter</span>(center_lon<span class="op">,</span> center_lat<span class="op">,</span> zoomlevel)<span class="op">;</span></span>
<span id="cb108-23"><a href="lab6.html#cb108-23" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(viirs_dmb_clipped<span class="op">,</span> nighttimeLightsVis<span class="op">,</span> <span class="st">&#39;California NightTime Lights&#39;</span>)<span class="op">;</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><strong>Conditional Operations</strong></li>
</ol>
<p>In this section, we will go over how to mask individual pixels based on conditional statements. This is one section that we will cover in JavaScript, but is probably easier to conduct in Python using ‘Pythonic’ methods and libraries such as NumPy. The charting is easer to work with in Python, but in the code chunk below, you can go through how to build a histogram smoothed with a Gaussian filter to identify where a value to might be appropriate. Then, build a binary mask using GEE’s built in conditionals:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb109-1"><a href="lab6.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">// get December image, we&#39;re using the &quot;avg_rad&quot; band</span></span>
<span id="cb109-2"><a href="lab6.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> viirs2019_12 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;NOAA/VIIRS/DNB/MONTHLY_V1/VCMSLCFG&quot;</span>)<span class="op">.</span><span class="fu">filterDate</span>(</span>
<span id="cb109-3"><a href="lab6.html#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2019-12-01&quot;</span><span class="op">,</span><span class="st">&quot;2019-12-31&quot;</span>)<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;avg_rad&#39;</span>)<span class="op">.</span><span class="fu">median</span>()</span>
<span id="cb109-4"><a href="lab6.html#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co">// center on Catalonia</span></span>
<span id="cb109-5"><a href="lab6.html#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> lat <span class="op">=</span> <span class="fl">41.83</span></span>
<span id="cb109-6"><a href="lab6.html#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> lon <span class="op">=</span> <span class="fl">1.67</span></span>
<span id="cb109-7"><a href="lab6.html#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co">// create a 200 km buffer around the center of Catalonia</span></span>
<span id="cb109-8"><a href="lab6.html#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> aoi <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>(lon<span class="op">,</span> lat)<span class="op">.</span><span class="fu">buffer</span>(<span class="dv">200000</span>)<span class="op">;</span></span></code></pre></div>
<p><strong>Build the Histogram</strong></p>
<p>This histogram is quite tough to read, but there are values that range from 0 to over 1000 - note that the vast majority fall within the range of 0 and 4. This is used to get a basic understanding of our data.</p>
<p>——–&gt; Need to improve</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb110-1"><a href="lab6.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">// </span></span>
<span id="cb110-2"><a href="lab6.html#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> hist <span class="op">=</span> viirs2019_12<span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb110-3"><a href="lab6.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">autoHistogram</span>()<span class="op">,</span></span>
<span id="cb110-4"><a href="lab6.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> aoi<span class="op">,</span></span>
<span id="cb110-5"><a href="lab6.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb110-6"><a href="lab6.html#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bestEffort</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb110-7"><a href="lab6.html#cb110-7" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb110-8"><a href="lab6.html#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co">// The result of the region reduction by `autoHistogram` is an array. Get the</span></span>
<span id="cb110-9"><a href="lab6.html#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co">// array and cast it as such for good measure.</span></span>
<span id="cb110-10"><a href="lab6.html#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> histArray <span class="op">=</span> ee<span class="op">.</span><span class="fu">Array</span>(hist<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;avg_rad&#39;</span>)) <span class="op">;</span></span>
<span id="cb110-11"><a href="lab6.html#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(histArray)</span>
<span id="cb110-12"><a href="lab6.html#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="co">// Subset the values that represent the bottom of the bins and project to</span></span>
<span id="cb110-13"><a href="lab6.html#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="co">// a single dimension. Result is a 1-D array.</span></span>
<span id="cb110-14"><a href="lab6.html#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> binBottom <span class="op">=</span> histArray<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">.</span><span class="fu">project</span>([<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb110-15"><a href="lab6.html#cb110-15" aria-hidden="true" tabindex="-1"></a><span class="co">// Subset the values that represent the number of pixels per bin and project to</span></span>
<span id="cb110-16"><a href="lab6.html#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="co">// a single dimension. Result is a 1-D array.</span></span>
<span id="cb110-17"><a href="lab6.html#cb110-17" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nPixels <span class="op">=</span> histArray<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="kw">null</span>)<span class="op">.</span><span class="fu">project</span>([<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb110-18"><a href="lab6.html#cb110-18" aria-hidden="true" tabindex="-1"></a><span class="co">// Chart the two arrays using the `ui.Chart.array.values` function.</span></span>
<span id="cb110-19"><a href="lab6.html#cb110-19" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> histColumnFromArray <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">array</span><span class="op">.</span><span class="fu">values</span>({</span>
<span id="cb110-20"><a href="lab6.html#cb110-20" aria-hidden="true" tabindex="-1"></a>  <span class="dt">array</span><span class="op">:</span>nPixels<span class="op">,</span></span>
<span id="cb110-21"><a href="lab6.html#cb110-21" aria-hidden="true" tabindex="-1"></a>  <span class="dt">axis</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb110-22"><a href="lab6.html#cb110-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">xLabels</span><span class="op">:</span> binBottom})</span>
<span id="cb110-23"><a href="lab6.html#cb110-23" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setChartType</span>(<span class="st">&#39;ColumnChart&#39;</span>)<span class="op">;</span></span>
<span id="cb110-24"><a href="lab6.html#cb110-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(histColumnFromArray)<span class="op">;</span></span></code></pre></div>
<p><strong>Mask values</strong></p>
<p>The histogram shows us that a massive number of values fall near zero - if we build a mask using GEE’s built in conditionals to keep only pixels that have a value above 4, the output allows us to focus in on areas that have meaningful values. Additionally, this will improve compute time and analysis.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb111-1"><a href="lab6.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Output is a binary mask (0-1)</span></span>
<span id="cb111-2"><a href="lab6.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> mask_value <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb111-3"><a href="lab6.html#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> viirs2019_12_mask <span class="op">=</span> viirs2019_12<span class="op">.</span><span class="fu">gte</span>(mask_value)</span>
<span id="cb111-4"><a href="lab6.html#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Initialize our map</span></span>
<span id="cb111-5"><a href="lab6.html#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nighttimeVis <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">120.0</span>}<span class="op">;</span></span>
<span id="cb111-6"><a href="lab6.html#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setCenter</span>(lon<span class="op">,</span> lat<span class="op">,</span> <span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb111-7"><a href="lab6.html#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(viirs2019_12<span class="op">.</span><span class="fu">mask</span>(viirs2019_12_mask)<span class="op">,</span> nighttimeVis<span class="op">,</span>  <span class="st">&#39;Nighttime&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="figure">
<img src="im/im_07_03.png" alt="" />
<p class="caption">im_07_03</p>
</div>
<p>Note that just like in the lab, you can chain together conditionals to make a layered mask, and build a customized pallette.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb112-1"><a href="lab6.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> zones <span class="op">=</span> viirs2019_12<span class="op">.</span><span class="fu">gt</span>(<span class="fl">1.5</span>)<span class="op">.</span><span class="fu">add</span>(viirs2019_12<span class="op">.</span><span class="fu">gt</span>(<span class="dv">2</span>))<span class="op">.</span><span class="fu">add</span>(viirs2019_12<span class="op">.</span><span class="fu">gt</span>(<span class="dv">5</span>))</span>
<span id="cb112-2"><a href="lab6.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Initialize our map</span></span>
<span id="cb112-3"><a href="lab6.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nighttimeVis <span class="op">=</span> {<span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">120.0</span>}<span class="op">;</span></span>
<span id="cb112-4"><a href="lab6.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setCenter</span>(lon<span class="op">,</span> lat<span class="op">,</span> <span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb112-5"><a href="lab6.html#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(zones<span class="op">.</span><span class="fu">mask</span>(zones)<span class="op">,</span> {<span class="st">&#39;palette&#39;</span><span class="op">:</span>[<span class="st">&#39;#cc0909&#39;</span><span class="op">,</span><span class="st">&#39;#e67525&#39;</span><span class="op">,</span><span class="st">&#39;#fff825&#39;</span>]}<span class="op">,</span> <span class="st">&#39;zones&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="figure">
<img src="im/im_07_04.png" alt="" />
<p class="caption">im_07_04</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li><strong>Cell Statistics and Band Math</strong></li>
</ol>
<p>It is worthwhile to read through this section thoroughly on the World Bank tutorial, as the techniques you learn here will be very useful in later sections. We will go over scaling an image to center each pixel at zero. We are working in the region of East Timor - the general process is to read in the December 2017 Nighttime Lights average, clip it to the East Timor Feature Collection, and then calculate the mean and standard deviation using the <code>reduceRegion</code> function. Now that we have those values, we can standardize the scaling. Compare the before and after images - in the first, it is very difficult to get any meaningful values, because the range of values is so narrow. Once scaled, we can more easily differentiate between urban areas and rural areas. You will also note that by doing this, the noise increases as well, as you can tell from the reduced ‘sharpness’ of the image. This can be an issue in many cases, and will be addressed in other components of the module.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb113-1"><a href="lab6.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">// get December image, we&#39;re using the &quot;avg_rad&quot; band</span></span>
<span id="cb113-2"><a href="lab6.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> viirs2017_12 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(</span>
<span id="cb113-3"><a href="lab6.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;NOAA/VIIRS/DNB/MONTHLY_V1/VCMSLCFG&quot;</span>)<span class="op">.</span><span class="fu">filterDate</span>(</span>
<span id="cb113-4"><a href="lab6.html#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2017-12-01&quot;</span><span class="op">,</span><span class="st">&quot;2017-12-31&quot;</span>)<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;avg_rad&#39;</span>)<span class="op">.</span><span class="fu">first</span>()</span>
<span id="cb113-5"><a href="lab6.html#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co">// get the geometry for Timor-Leste from GEE&#39;s tagged datasets</span></span>
<span id="cb113-6"><a href="lab6.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> tls <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="fu">FeatureCollection</span>(</span>
<span id="cb113-7"><a href="lab6.html#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;FAO/GAUL/2015/level0&quot;</span>)<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(</span>
<span id="cb113-8"><a href="lab6.html#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;ADM0_NAME&#39;</span><span class="op">,</span> <span class="st">&#39;Timor-Leste&#39;</span>))<span class="op">.</span><span class="fu">first</span>())<span class="op">.</span><span class="fu">geometry</span>()</span>
<span id="cb113-9"><a href="lab6.html#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co">// clip our VIIRS image to Timor-Leste</span></span>
<span id="cb113-10"><a href="lab6.html#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> ntl_tls <span class="op">=</span> viirs2017_12<span class="op">.</span><span class="fu">clip</span>(tls)</span>
<span id="cb113-11"><a href="lab6.html#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Set visibility parameters</span></span>
<span id="cb113-12"><a href="lab6.html#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nighttimeLightsVis <span class="op">=</span> {</span>
<span id="cb113-13"><a href="lab6.html#cb113-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="fl">3.0</span><span class="op">,</span></span>
<span id="cb113-14"><a href="lab6.html#cb113-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="fl">60.0</span><span class="op">,</span></span>
<span id="cb113-15"><a href="lab6.html#cb113-15" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb113-16"><a href="lab6.html#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setCenter</span>(<span class="fl">126.25</span><span class="op">,</span> <span class="op">-</span><span class="fl">8.5</span><span class="op">,</span> <span class="dv">9</span>)<span class="op">;</span></span>
<span id="cb113-17"><a href="lab6.html#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(ntl_tls<span class="op">,</span> nighttimeLightsVis<span class="op">,</span> <span class="st">&#39;&quot;VIIRS-DNB Dec 2017&quot;&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="figure">
<img src="im/im_07_05.png" alt="" />
<p class="caption">im_07_05</p>
</div>
<div class="sourceCode" id="cb114"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb114-1"><a href="lab6.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Reduce image to find the mean and standard deviation</span></span>
<span id="cb114-2"><a href="lab6.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> mu <span class="op">=</span> ntl_tls<span class="op">.</span><span class="fu">reduceRegion</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>())</span>
<span id="cb114-3"><a href="lab6.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> std <span class="op">=</span> ntl_tls<span class="op">.</span><span class="fu">reduceRegion</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">stdDev</span>())</span>
<span id="cb114-4"><a href="lab6.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Convert these to Numbers using the ee.Number constructor</span></span>
<span id="cb114-5"><a href="lab6.html#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> mu <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(mu<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;avg_rad&#39;</span>))</span>
<span id="cb114-6"><a href="lab6.html#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> std <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(std<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;avg_rad&#39;</span>))</span>
<span id="cb114-7"><a href="lab6.html#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Print Output to ensure values look correct</span></span>
<span id="cb114-8"><a href="lab6.html#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Mean Avg Radiance&#39;</span><span class="op">,</span> mu<span class="op">.</span><span class="fu">getInfo</span>())</span>
<span id="cb114-9"><a href="lab6.html#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;StdDev&#39;</span><span class="op">,</span> std<span class="op">.</span><span class="fu">getInfo</span>())</span>
<span id="cb114-10"><a href="lab6.html#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co">// Subtract mean and divide by standard deviation</span></span>
<span id="cb114-11"><a href="lab6.html#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> ntl_tls_std <span class="op">=</span> ntl_tls<span class="op">.</span><span class="fu">subtract</span>(mu)<span class="op">.</span><span class="fu">divide</span>(std)</span>
<span id="cb114-12"><a href="lab6.html#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co">// Set visibility parameters</span></span>
<span id="cb114-13"><a href="lab6.html#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nighttimeLightsVis <span class="op">=</span> {</span>
<span id="cb114-14"><a href="lab6.html#cb114-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="op">-</span><span class="dv">4</span><span class="op">,</span></span>
<span id="cb114-15"><a href="lab6.html#cb114-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb114-16"><a href="lab6.html#cb114-16" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb114-17"><a href="lab6.html#cb114-17" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setCenter</span>(<span class="fl">126.25</span><span class="op">,</span> <span class="op">-</span><span class="fl">8.5</span><span class="op">,</span> <span class="dv">9</span>)<span class="op">;</span></span>
<span id="cb114-18"><a href="lab6.html#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(ntl_tls_std<span class="op">,</span> nighttimeLightsVis<span class="op">,</span> <span class="st">&#39;Scaled Image&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="figure">
<img src="im/im_07_06.png" alt="" />
<p class="caption">im_07_06</p>
</div>
<ol start="5" style="list-style-type: decimal">
<li><strong>Expressions</strong></li>
</ol>
<p>In this module, we will work with the <code>.expression()</code> methods built-into images. This allows us to work with customized functions and complete more advanced band math than pre-built functionality. This is a very short module, but the key point here is that being able to manipulate and find unique relationships in imagery. Once you understand how to build an expression, opportunities are limitless. In the images below, we invert the pixel values by multiplying each pixel by -1 and adding 63 (max value).</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb115-1"><a href="lab6.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">// get 1996 composite, apply mask, and add as layer</span></span>
<span id="cb115-2"><a href="lab6.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> dmsp1996 <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">&quot;NOAA/DMSP-OLS/NIGHTTIME_LIGHTS/F121996&quot;</span>)<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;stable_lights&#39;</span>)</span>
<span id="cb115-3"><a href="lab6.html#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> lat <span class="op">=</span> <span class="fl">19.43</span></span>
<span id="cb115-4"><a href="lab6.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> lon <span class="op">=</span> <span class="op">-</span><span class="fl">99.13</span></span>
<span id="cb115-5"><a href="lab6.html#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nighttimeLightsVis <span class="op">=</span> {</span>
<span id="cb115-6"><a href="lab6.html#cb115-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span></span>
<span id="cb115-7"><a href="lab6.html#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="fl">63.0</span><span class="op">,</span></span>
<span id="cb115-8"><a href="lab6.html#cb115-8" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb115-9"><a href="lab6.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setCenter</span>(lon<span class="op">,</span> lat<span class="op">,</span> <span class="dv">7</span>)<span class="op">;</span></span>
<span id="cb115-10"><a href="lab6.html#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(dmsp1996<span class="op">,</span> nighttimeLightsVis<span class="op">,</span> <span class="st">&#39;1996 Composite&#39;</span>)</span></code></pre></div>
<div class="figure">
<img src="im/im_07_07.png" alt="" />
<p class="caption">im_07_07</p>
</div>
<div class="sourceCode" id="cb116"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb116-1"><a href="lab6.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Use Expression to invert the pixels</span></span>
<span id="cb116-2"><a href="lab6.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> dmsp1996_inv <span class="op">=</span> dmsp1996<span class="op">.</span><span class="fu">multiply</span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">.</span><span class="fu">add</span>(<span class="dv">63</span>)</span>
<span id="cb116-3"><a href="lab6.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(dmsp1996_inv<span class="op">,</span> nighttimeLightsVis<span class="op">,</span> <span class="st">&#39;1996 Composite Inverse&#39;</span>)</span></code></pre></div>
<div class="figure">
<img src="im/im_07_08.png" alt="" />
<p class="caption">im_07_08</p>
</div>
<ol start="6" style="list-style-type: decimal">
<li><strong>Expression (Continued)</strong></li>
</ol>
<p>In the previous example we built an expression using some of the GEE built-in operations, such as <code>.multiplication()</code> and <code>.add()</code>. This works well for that specific use case, but is limiting when you need to use operations that are not specifically provided within GEE. Another methodology is to build our expression with a string and then provide the input as a key-value pair. See the code chunk below for the methodology. Additionally, for calculations that involve massive amounts of data, there are some speed advantages in doing it this way. Follow along with the World Bank tutorial using this methodology, and try to build some of your own functions to see the result. Using ‘Inspector’ would be helpful to test whether your function acted as expected.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb117-1"><a href="lab6.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> inv_formula <span class="op">=</span> <span class="st">&quot;(X*-1) + 63&quot;</span></span>
<span id="cb117-2"><a href="lab6.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co">// We plug this formula in, identify our variable &quot;X&quot; and set it to our 1996 DMSP-OLS &quot;stable_lights&quot; band</span></span>
<span id="cb117-3"><a href="lab6.html#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> dmsp1996_inv2 <span class="op">=</span> dmsp1996<span class="op">.</span><span class="fu">expression</span>(inv_formula<span class="op">,</span> {<span class="st">&#39;X&#39;</span><span class="op">:</span>dmsp1996})</span>
<span id="cb117-4"><a href="lab6.html#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(dmsp1996_inv2<span class="op">,</span> nighttimeLightsVis<span class="op">,</span> <span class="st">&#39;1996 Composite Inverse&#39;</span>)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li><strong>Make a Composite</strong></li>
</ol>
<p>Building a temporal composite is an important part of analysis and modeling. We went through these concepts in earlier labs, although this tutorial extends some of the functionality.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb118-1"><a href="lab6.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">// 2015 image collection - &quot;avg_rad&quot; band</span></span>
<span id="cb118-2"><a href="lab6.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> viirs2015 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;NOAA/VIIRS/DNB/MONTHLY_V1/VCMSLCFG&quot;</span>)<span class="op">.</span><span class="fu">filterDate</span>(</span>
<span id="cb118-3"><a href="lab6.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;2015-01-01&quot;</span><span class="op">,</span><span class="st">&quot;2015-12-31&quot;</span>)<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;avg_rad&#39;</span>)</span>
<span id="cb118-4"><a href="lab6.html#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Confirm that there are 12 images in this collection </span></span>
<span id="cb118-5"><a href="lab6.html#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Images:&#39;</span><span class="op">,</span> viirs2015<span class="op">.</span><span class="fu">size</span>()<span class="op">.</span><span class="fu">getInfo</span>())</span>
<span id="cb118-6"><a href="lab6.html#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> viirs2015med <span class="op">=</span> viirs2015<span class="op">.</span><span class="fu">median</span>()</span>
<span id="cb118-7"><a href="lab6.html#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co">// iniatialize map on Sao Paulo</span></span>
<span id="cb118-8"><a href="lab6.html#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> lat <span class="op">=</span> <span class="op">-</span><span class="fl">23.54</span></span>
<span id="cb118-9"><a href="lab6.html#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> lon <span class="op">=</span> <span class="op">-</span><span class="fl">46.63</span></span>
<span id="cb118-10"><a href="lab6.html#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nighttimeLightsVis <span class="op">=</span> {</span>
<span id="cb118-11"><a href="lab6.html#cb118-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">min</span><span class="op">:</span> <span class="fl">0.0</span><span class="op">,</span></span>
<span id="cb118-12"><a href="lab6.html#cb118-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="fl">63.0</span><span class="op">,</span></span>
<span id="cb118-13"><a href="lab6.html#cb118-13" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb118-14"><a href="lab6.html#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="co">// Initialize the map</span></span>
<span id="cb118-15"><a href="lab6.html#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setCenter</span>(lon<span class="op">,</span> lat<span class="op">,</span> <span class="dv">7</span>)<span class="op">;</span></span>
<span id="cb118-16"><a href="lab6.html#cb118-16" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(viirs2015med<span class="op">.</span><span class="fu">mask</span>(viirs2015med)<span class="op">,</span> nighttimeLightsVis<span class="op">,</span> <span class="st">&#39;2015 Monthly Median&#39;</span>)</span></code></pre></div>
<div class="figure">
<img src="im/im_07_09.png" alt="" />
<p class="caption">im_07_09</p>
</div>
<p>——&gt; Research alternative to loop - convert function in 7.4.3 to <code>.map</code></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb119-1"><a href="lab6.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Define start and end years</span></span>
<span id="cb119-2"><a href="lab6.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> start <span class="op">=</span> <span class="dv">2015</span></span>
<span id="cb119-3"><a href="lab6.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> end <span class="op">=</span> <span class="dv">2019</span></span>
<span id="cb119-4"><a href="lab6.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> years <span class="op">=</span> ee<span class="op">.</span><span class="at">List</span><span class="op">.</span><span class="fu">sequence</span>(start<span class="op">,</span> end)</span>
<span id="cb119-5"><a href="lab6.html#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Number of years: &#39;</span><span class="op">,</span> years<span class="op">.</span><span class="fu">size</span>()<span class="op">.</span><span class="fu">getInfo</span>())</span>
<span id="cb119-6"><a href="lab6.html#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> colID <span class="op">=</span> <span class="st">&quot;NOAA/VIIRS/DNB/MONTHLY_V1/VCMSLCFG&quot;</span></span>
<span id="cb119-7"><a href="lab6.html#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">viirs_annual_median_reduce</span>(year) {</span>
<span id="cb119-8"><a href="lab6.html#cb119-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(colID)<span class="op">.</span><span class="fu">filter</span>(            ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">calendarRange</span>(year<span class="op">,</span>year<span class="op">,</span><span class="st">&quot;year&quot;</span>))<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb119-9"><a href="lab6.html#cb119-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;avg_rad&quot;</span>)<span class="op">.</span><span class="fu">median</span>()<span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;year&#39;</span><span class="op">,</span>year)</span>
<span id="cb119-10"><a href="lab6.html#cb119-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-11"><a href="lab6.html#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Map function to each year in our list</span></span>
<span id="cb119-12"><a href="lab6.html#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> yearComps <span class="op">=</span> ee<span class="op">.</span><span class="at">ImageCollection</span><span class="op">.</span><span class="fu">fromImages</span>(years<span class="op">.</span><span class="fu">map</span>(viirs_annual_median_reduce))</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li><strong>Importing and Exporting Data</strong></li>
</ol>
<p>Using the GEE code editor is relatively straightforward for importing spatial files, such as Shapefiles. Follow the <a href="https://developers.google.com/earth-engine/guides/table_upload?hl=en">documentation</a> and you should be able to import the data that you need.</p>
<p>While the <a href="https://developers.google.com/earth-engine/guides/exporting?hl=en">documentation</a> on exporting data is also relatively straightforward, it is important to understand exactly what you are exporting.</p>
<p>Refer to lab 01 for more information and some examples of importing and exporting data.</p>
</div>
<div id="conclusion" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Conclusion</h2>
<p>As noted earlier, this lab is more of a JavaScript supplement to the excellent World Bank tutorial. There are many data and remote sensing libraries in Python that can help you take your work to the next stage.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lab5.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rsss.pdf", "rsss.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection",
"edit": "https://github.com/rstudio/bookdown-demo/edit/master/%s",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
