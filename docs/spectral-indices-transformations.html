<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lab 3 Spectral Indices &amp; Transformations | Remote Sensing in the Social Sciences</title>
  <meta name="description" content="Lab 3 Spectral Indices &amp; Transformations | Remote Sensing in the Social Sciences" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Lab 3 Spectral Indices &amp; Transformations | Remote Sensing in the Social Sciences" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lab 3 Spectral Indices &amp; Transformations | Remote Sensing in the Social Sciences" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lab2.html"/>

<script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html"><i class="fa fa-check"></i>PreLab: Getting Started</a><ul>
<li class="chapter" data-level="" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#overview"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="0.1" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#data-and-methods"><i class="fa fa-check"></i><b>0.1</b> Data and Methods</a></li>
<li class="chapter" data-level="0.2" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#images-and-image-collections"><i class="fa fa-check"></i><b>0.2</b> Images and Image Collections</a><ul>
<li class="chapter" data-level="0.2.1" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#images"><i class="fa fa-check"></i><b>0.2.1</b> Images</a></li>
<li class="chapter" data-level="0.2.2" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#image-collections"><i class="fa fa-check"></i><b>0.2.2</b> Image Collections</a></li>
<li class="chapter" data-level="0.2.3" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#sensed-versus-derived-imagery"><i class="fa fa-check"></i><b>0.2.3</b> Sensed versus Derived Imagery</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#geometries"><i class="fa fa-check"></i><b>0.3</b> Geometries</a></li>
<li class="chapter" data-level="0.4" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#features-and-feature-collections"><i class="fa fa-check"></i><b>0.4</b> Features and Feature Collections</a><ul>
<li class="chapter" data-level="0.4.1" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#features"><i class="fa fa-check"></i><b>0.4.1</b> Features</a></li>
<li class="chapter" data-level="0.4.2" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#feature-collections"><i class="fa fa-check"></i><b>0.4.2</b> Feature Collections</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#methods-reducers"><i class="fa fa-check"></i><b>0.5</b> Methods: Reducers</a></li>
<li class="chapter" data-level="0.6" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#joins-and-arrays"><i class="fa fa-check"></i><b>0.6</b> Joins and Arrays</a><ul>
<li class="chapter" data-level="0.6.1" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#join"><i class="fa fa-check"></i><b>0.6.1</b> Join</a></li>
<li class="chapter" data-level="0.6.2" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#arrays"><i class="fa fa-check"></i><b>0.6.2</b> Arrays</a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path="prelab-getting-started.html"><a href="prelab-getting-started.html#additional-resources"><i class="fa fa-check"></i><b>0.7</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="lab1.html"><a href="lab1.html"><i class="fa fa-check"></i><b>1</b> Remote Sensing Background</a><ul>
<li class="chapter" data-level="" data-path="lab1.html"><a href="lab1.html#overview-1"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="1.1" data-path="lab1.html"><a href="lab1.html#what-is-a-digital-image"><i class="fa fa-check"></i><b>1.1</b> What is a digital image?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="lab1.html"><a href="lab1.html#from-digital-image-to-geospatial-image"><i class="fa fa-check"></i><b>1.1.1</b> From digital image to geospatial image</a></li>
<li class="chapter" data-level="1.1.2" data-path="lab1.html"><a href="lab1.html#visualize-a-digital-image"><i class="fa fa-check"></i><b>1.1.2</b> Visualize a Digital Image</a></li>
<li class="chapter" data-level="1.1.3" data-path="lab1.html"><a href="lab1.html#digital-image-visualization-and-stretching"><i class="fa fa-check"></i><b>1.1.3</b> Digital Image Visualization and Stretching</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="lab1.html"><a href="lab1.html#spatial-resolution"><i class="fa fa-check"></i><b>1.2</b> Spatial Resolution</a><ul>
<li class="chapter" data-level="1.2.1" data-path="lab1.html"><a href="lab1.html#modis"><i class="fa fa-check"></i><b>1.2.1</b> MODIS</a></li>
<li class="chapter" data-level="1.2.2" data-path="lab1.html"><a href="lab1.html#multispectral-scanners"><i class="fa fa-check"></i><b>1.2.2</b> Multispectral Scanners</a></li>
<li class="chapter" data-level="1.2.3" data-path="lab1.html"><a href="lab1.html#thematic-mapper-tm"><i class="fa fa-check"></i><b>1.2.3</b> Thematic Mapper (TM)</a></li>
<li class="chapter" data-level="1.2.4" data-path="lab1.html"><a href="lab1.html#national-agriculture-imagery-program-naip"><i class="fa fa-check"></i><b>1.2.4</b> National Agriculture Imagery Program (NAIP)</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="lab1.html"><a href="lab1.html#spectral-resolution"><i class="fa fa-check"></i><b>1.3</b> Spectral Resolution</a></li>
<li class="chapter" data-level="1.4" data-path="lab1.html"><a href="lab1.html#temporal-resolution"><i class="fa fa-check"></i><b>1.4</b> Temporal Resolution</a><ul>
<li class="chapter" data-level="1.4.1" data-path="lab1.html"><a href="lab1.html#modis-1"><i class="fa fa-check"></i><b>1.4.1</b> MODIS</a></li>
<li class="chapter" data-level="1.4.2" data-path="lab1.html"><a href="lab1.html#landsat"><i class="fa fa-check"></i><b>1.4.2</b> Landsat</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="lab1.html"><a href="lab1.html#radiometric-resolution"><i class="fa fa-check"></i><b>1.5</b> Radiometric Resolution</a></li>
<li class="chapter" data-level="1.6" data-path="lab1.html"><a href="lab1.html#resampling-and-reprojection"><i class="fa fa-check"></i><b>1.6</b> Resampling and ReProjection</a></li>
<li class="chapter" data-level="1.7" data-path="lab1.html"><a href="lab1.html#additional-exercises"><i class="fa fa-check"></i><b>1.7</b> Additional Exercises</a></li>
<li class="chapter" data-level="" data-path="lab1.html"><a href="lab1.html#where-to-submit"><i class="fa fa-check"></i>Where to submit</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lab2.html"><a href="lab2.html"><i class="fa fa-check"></i><b>2</b> Digital Imagery &amp; Image Processing</a><ul>
<li class="chapter" data-level="" data-path="lab2.html"><a href="lab2.html#overview-2"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="2.1" data-path="lab2.html"><a href="lab2.html#searching-for-imagery-exercise-1"><i class="fa fa-check"></i><b>2.1</b> Searching for Imagery (Exercise 1)</a></li>
<li class="chapter" data-level="2.2" data-path="lab2.html"><a href="lab2.html#visualizing-landsat-imagery"><i class="fa fa-check"></i><b>2.2</b> Visualizing Landsat Imagery</a></li>
<li class="chapter" data-level="2.3" data-path="lab2.html"><a href="lab2.html#plot-at-sensor-radiance"><i class="fa fa-check"></i><b>2.3</b> Plot at-Sensor Radiance</a></li>
<li class="chapter" data-level="2.4" data-path="lab2.html"><a href="lab2.html#plot-top-of-atmosphere-toa-reflectance"><i class="fa fa-check"></i><b>2.4</b> Plot Top-of-Atmosphere (TOA) Reflectance</a></li>
<li class="chapter" data-level="2.5" data-path="lab2.html"><a href="lab2.html#plot-surface-reflectance"><i class="fa fa-check"></i><b>2.5</b> Plot Surface Reflectance</a></li>
<li class="chapter" data-level="2.6" data-path="lab2.html"><a href="lab2.html#additional-exercises-1"><i class="fa fa-check"></i><b>2.6</b> Additional Exercises</a></li>
<li class="chapter" data-level="" data-path="lab2.html"><a href="lab2.html#where-to-submit-1"><i class="fa fa-check"></i>Where to submit</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html"><i class="fa fa-check"></i><b>3</b> Spectral Indices &amp; Transformations</a><ul>
<li class="chapter" data-level="" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#overview-3"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="3.1" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#spectral-indices"><i class="fa fa-check"></i><b>3.1</b> Spectral Indices</a><ul>
<li class="chapter" data-level="3.1.1" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#important-indices"><i class="fa fa-check"></i><b>3.1.1</b> Important Indices</a></li>
<li class="chapter" data-level="3.1.2" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#linear-transformations"><i class="fa fa-check"></i><b>3.1.2</b> Linear Transformations</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#spectral-transformation"><i class="fa fa-check"></i><b>3.2</b> Spectral Transformation</a><ul>
<li class="chapter" data-level="3.2.1" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#linear-filtering"><i class="fa fa-check"></i><b>3.2.1</b> Linear Filtering</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#additional-exercises-2"><i class="fa fa-check"></i><b>3.3</b> Additional Exercises</a></li>
<li class="chapter" data-level="" data-path="spectral-indices-transformations.html"><a href="spectral-indices-transformations.html#where-to-submit-2"><i class="fa fa-check"></i>Where to submit</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Remote Sensing in the Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spectral-indices-transformations" class="section level1">
<h1><span class="header-section-number">Lab 3</span> Spectral Indices &amp; Transformations</h1>
<div id="overview-3" class="section level2 unnumbered">
<h2>Overview</h2>
<p>The purpose of this lab is to enable you to extract, visualize, combine, and transform spectral data in GEE so as to highlight and indicate the relative abundance of particular features of interest from an image. At completion, you should be able to understand the difference between wavelengths, load visualizations displaying relevant indices, compare the relevant applications for varying spectral transformations, and compute and examine image texture.</p>
</div>
<div id="spectral-indices" class="section level2">
<h2><span class="header-section-number">3.1</span> Spectral Indices</h2>
<p>Spectral indices are based on the fact that reflectance spectra of different land cover types have unique characteristics. We can build custom indices designed to exploit these differences to accentuate particular land cover types. Consider the following chart of reflectance spectra for various targets.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:specindices"></span>
<img src="spectral_indices_lab3.png" alt="Sample Spectral Reflectance Curves" width="95%" />
<p class="caption">
Figure 3.1: Sample Spectral Reflectance Curves
</p>
</div>
<p>Observe that the land covers are separable at one or more wavelengths. Note, in particular, that vegetation curves (green) have relatively high reflectance in the NIR range, where radiant energy is scattered by cell walls (<a href="http://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19850022138.pdf">Bowker et al.¬†1985</a>). Also note that vegetation has low reflectance in the red range, where radiant energy is <a href="https://en.wikipedia.org/wiki/Chlorophyll#/media/File:Chlorophyll_ab_spectra-en.svg">absorbed by chlorophyll</a>. These observations motivate the formulation of vegetation indices, some of which are described in the following sections.</p>
<div id="important-indices" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Important Indices</h3>
<div id="normalized-difference-vegetation-index-ndvi" class="section level4">
<h4><span class="header-section-number">3.1.1.1</span> Normalized Difference Vegetation Index (NDVI)</h4>
<p>The Normalized Difference Vegetation Index (NDVI) has a <a href="https://en.wikipedia.org/wiki/Normalized_Difference_Vegetation_Index">long history</a> in remote sensing. The typical formulation is</p>
<p><span class="math display">\[ \text{NDVI} = (\text{NIR} - \text{red}) / (\text{NIR} + \text{red}) \]</span></p>
<p>Where <em>NIR</em> and <em>red</em> refer to reflectance, radiance or DN at the respective wavelength. Implement indices of this form in Earth Engine with the normalizedDifference() method. First, get an image of interest by drawing a Point named <code>point</code> over SFO airport, importing the <code>Landsat 8 Collection 1 Tier 1 TOA Reflectance</code> as landsat8 and sorting the collection by cloud cover metadata:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="spectral-indices-transformations.html#cb1-1"></a><span class="kw">var</span>  image <span class="op">=</span> <span class="va">ee</span>.<span class="at">Image</span>(landsat8     </span>
<span id="cb1-2"><a href="spectral-indices-transformations.html#cb1-2"></a>                      .<span class="at">filterBounds</span>(point)     </span>
<span id="cb1-3"><a href="spectral-indices-transformations.html#cb1-3"></a>                      .<span class="at">filterDate</span>(<span class="st">&#39;2015-06-01&#39;</span><span class="op">,</span> <span class="st">&#39;2015-09-01&#39;</span>)</span>
<span id="cb1-4"><a href="spectral-indices-transformations.html#cb1-4"></a>                      .<span class="at">sort</span>(<span class="st">&#39;CLOUD_COVER&#39;</span>)</span>
<span id="cb1-5"><a href="spectral-indices-transformations.html#cb1-5"></a>                      .<span class="at">first</span>())<span class="op">;</span></span>
<span id="cb1-6"><a href="spectral-indices-transformations.html#cb1-6"></a><span class="kw">var</span> trueColor <span class="op">=</span> <span class="op">{</span><span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span> </span>
<span id="cb1-7"><a href="spectral-indices-transformations.html#cb1-7"></a>                 <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">0.3</span><span class="op">};</span>   </span>
<span id="cb1-8"><a href="spectral-indices-transformations.html#cb1-8"></a><span class="va">Map</span>.<span class="at">addLayer</span>(image<span class="op">,</span> trueColor<span class="op">,</span> <span class="st">&#39;image&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<p>The NDVI computation is one line:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="spectral-indices-transformations.html#cb2-1"></a><span class="kw">var</span>  ndvi <span class="op">=</span> <span class="va">image</span>.<span class="at">normalizedDifference</span>([<span class="st">&#39;B5&#39;</span><span class="op">,</span> <span class="st">&#39;B4&#39;</span>])<span class="op">;</span>  </span></code></pre></div>
<p>Display the NDVI image with a color palette (feel free to make a better one):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="spectral-indices-transformations.html#cb3-1"></a><span class="kw">var</span>  vegPalette <span class="op">=</span> [<span class="st">&#39;white&#39;</span><span class="op">,</span> <span class="st">&#39;green&#39;</span>]<span class="op">;</span>   </span>
<span id="cb3-2"><a href="spectral-indices-transformations.html#cb3-2"></a><span class="va">Map</span>.<span class="at">addLayer</span>(ndvi<span class="op">,</span> <span class="op">{</span><span class="dt">min</span><span class="op">:</span> <span class="dv">-1</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span>  </span>
<span id="cb3-3"><a href="spectral-indices-transformations.html#cb3-3"></a>                    <span class="dt">palette</span><span class="op">:</span> vegPalette<span class="op">},</span> <span class="st">&#39;NDVI&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<p>Use the <strong>Inspector</strong> to check pixel values in areas of vegetation and non-vegetation.</p>
<hr />
<p><i class="fa fa-file"></i> <strong>1. What are some of the sample pixel values of the NDVI in areas of vegetation vs.¬†urban features vs.¬†bare earth vs.¬†water? Indicate which parts of the images you used and how you determined what each of their values were.</strong></p>
<hr />
</div>
<div id="enhanced-vegetation-index-evi" class="section level4">
<h4><span class="header-section-number">3.1.1.2</span> Enhanced Vegetation Index (EVI)</h4>
<p>The Enhanced Vegetation Index (EVI) is designed to minimize saturation and background effects in NDVI (<a href="http://www.sciencedirect.com/science/article/pii/S0034425702000962">Huete et al.¬†2002</a>). Since it is not a normalized difference index, compute it with <a href="https://developers.google.com/earth-engine/image_math#expressions">an expression</a>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="spectral-indices-transformations.html#cb4-1"></a><span class="kw">var</span> exp <span class="op">=</span> <span class="st">&#39;2.5  * ((NIR - RED) / (NIR + 6 * RED - 7.5 * BLUE + 1))&#39;</span><span class="op">;</span></span>
<span id="cb4-2"><a href="spectral-indices-transformations.html#cb4-2"></a><span class="kw">var</span> evi <span class="op">=</span> <span class="va">image</span>.<span class="at">expression</span>( exp<span class="op">,</span> </span>
<span id="cb4-3"><a href="spectral-indices-transformations.html#cb4-3"></a>                            <span class="op">{</span><span class="st">&#39;NIR&#39;</span><span class="op">:</span> <span class="va">image</span>.<span class="at">select</span>(<span class="st">&#39;B5&#39;</span>)<span class="op">,</span></span>
<span id="cb4-4"><a href="spectral-indices-transformations.html#cb4-4"></a>                             <span class="st">&#39;RED&#39;</span><span class="op">:</span> <span class="va">image</span>.<span class="at">select</span>(<span class="st">&#39;B4&#39;</span>)<span class="op">,</span></span>
<span id="cb4-5"><a href="spectral-indices-transformations.html#cb4-5"></a>                             <span class="st">&#39;BLUE&#39;</span><span class="op">:</span> <span class="va">image</span>.<span class="at">select</span>(<span class="st">&#39;B2&#39;</span>)</span>
<span id="cb4-6"><a href="spectral-indices-transformations.html#cb4-6"></a>                            <span class="op">}</span>)<span class="op">;</span>  </span></code></pre></div>
<p>Observe that bands are referenced with the help of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Grammar_and_Types#Object_literals">an object</a> that is passed as the second argument to image.expression(). Display EVI:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="spectral-indices-transformations.html#cb5-1"></a><span class="va">Map</span>.<span class="at">addLayer</span>(evi<span class="op">,</span>  </span>
<span id="cb5-2"><a href="spectral-indices-transformations.html#cb5-2"></a>             <span class="op">{</span><span class="dt">min</span><span class="op">:</span> <span class="dv">-1</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span>  <span class="dt">palette</span><span class="op">:</span> vegPalette<span class="op">},</span> </span>
<span id="cb5-3"><a href="spectral-indices-transformations.html#cb5-3"></a>             <span class="st">&#39;EVI&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<hr />
<p><i class="fa fa-file"></i> <strong>2a. Compare EVI to NDVI across those same land use categories as in the previous question. What do you observe ‚Äì how are the images and values similar or different across the two indices?</strong></p>
<hr />
</div>
<div id="normalized-difference-water-index-ndwi" class="section level4">
<h4><span class="header-section-number">3.1.1.3</span> Normalized Difference Water Index (NDWI)</h4>
<p>The Normalized Difference Water Index (NDWI) was developed by <a href="http://www.sciencedirect.com/science/article/pii/S0034425796000673">Gao (1996)</a> as an index of vegetation water content:</p>
<p><span class="math display">\[\text{NDWI} = (\text{NIR} - \text{SWIR})) / (\text{NIR} + \text{SWIR})\]</span></p>
<p>Compute NDWI in Earth Engine with:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb6-1"><a href="spectral-indices-transformations.html#cb6-1"></a><span class="kw">var</span> ndwi <span class="op">=</span> <span class="va">image</span>.<span class="at">normalizedDifference</span>([<span class="st">&#39;B5&#39;</span><span class="op">,</span> <span class="st">&#39;B6&#39;</span>])<span class="op">;</span>  </span></code></pre></div>
<p>And display:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb7-1"><a href="spectral-indices-transformations.html#cb7-1"></a><span class="kw">var</span> waterPalette <span class="op">=</span> [<span class="st">&#39;white&#39;</span><span class="op">,</span> <span class="st">&#39;blue&#39;</span>]<span class="op">;</span>   </span>
<span id="cb7-2"><a href="spectral-indices-transformations.html#cb7-2"></a><span class="va">Map</span>.<span class="at">addLayer</span>(ndwi<span class="op">,</span> </span>
<span id="cb7-3"><a href="spectral-indices-transformations.html#cb7-3"></a>             <span class="op">{</span><span class="dt">min</span><span class="op">:</span> <span class="fl">-0.5</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span>  </span>
<span id="cb7-4"><a href="spectral-indices-transformations.html#cb7-4"></a>              <span class="dt">palette</span><span class="op">:</span> waterPalette<span class="op">},</span> </span>
<span id="cb7-5"><a href="spectral-indices-transformations.html#cb7-5"></a>             <span class="st">&#39;NDWI&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<p>Note that this is not an exact implementation of NDWI, according to the <a href="http://landsat.gsfc.nasa.gov/?p=5779">OLI spectral response</a>, since OLI does not have a band in the right position (1.26 ùõçm).</p>
</div>
<div id="normalized-difference-water-body-index-ndwbi" class="section level4">
<h4><span class="header-section-number">3.1.1.4</span> Normalized Difference Water <em>Body</em> Index (NDWBI)</h4>
<p>It‚Äôs unfortunate that two <em>different</em> NDWI indices were independently invented in 1996. To distinguish, define the Normalized Difference Water <em>Body</em> Index (NDWBI) as the index described in <a href="http://www.tandfonline.com/doi/abs/10.1080/01431169608948714#.VkThFHyrTlM">McFeeters (1996)</a>:</p>
<p><span class="math display">\[\text{NDWBI} = (\text{green} - \text{NIR}) / (\text{green} + \text{NIR})\]</span></p>
<p>As previously, implement NDWBI with <code>normalizedDifference()</code> and display the result:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb8-1"><a href="spectral-indices-transformations.html#cb8-1"></a><span class="kw">var</span> ndwbi <span class="op">=</span> <span class="va">image</span>.<span class="at">normalizedDifference</span>([<span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B5&#39;</span>])<span class="op">;</span>   </span>
<span id="cb8-2"><a href="spectral-indices-transformations.html#cb8-2"></a><span class="va">Map</span>.<span class="at">addLayer</span>(ndwbi<span class="op">,</span> </span>
<span id="cb8-3"><a href="spectral-indices-transformations.html#cb8-3"></a>             <span class="op">{</span><span class="dt">min</span><span class="op">:</span> <span class="dv">-1</span><span class="op">,</span> </span>
<span id="cb8-4"><a href="spectral-indices-transformations.html#cb8-4"></a>              <span class="dt">max</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span>  </span>
<span id="cb8-5"><a href="spectral-indices-transformations.html#cb8-5"></a>              <span class="dt">palette</span><span class="op">:</span> waterPalette<span class="op">},</span> </span>
<span id="cb8-6"><a href="spectral-indices-transformations.html#cb8-6"></a>             <span class="st">&#39;NDWBI&#39;</span>)<span class="op">;</span>   </span></code></pre></div>
<hr />
<p><i class="fa fa-file"></i> <strong>2b. Compare NDWI and NDWBI. What do you observe?</strong></p>
<hr />
</div>
<div id="normalized-difference-bare-index-ndbi" class="section level4">
<h4><span class="header-section-number">3.1.1.5</span> Normalized Difference Bare Index (NDBI)</h4>
<p>The Normalized Difference Bare Index (NDBI) was developed by <a href="http://www.tandfonline.com/doi/abs/10.1080/01431160304987">Zha et al.¬†(2003)</a> to aid in the differentiation of urban areas:</p>
<p><span class="math display">\[ \text{NDBI} = (\text{SWIR} - \text{NIR}) / (\text{SWIR} + \text{NIR}) \]</span></p>
<p>Note that NDBI is the negative of NDWI. Compute NDBI and display with a suitable palette:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb9-1"><a href="spectral-indices-transformations.html#cb9-1"></a><span class="kw">var</span> ndbi <span class="op">=</span> <span class="va">image</span>.<span class="at">normalizedDifference</span>([<span class="st">&#39;B6&#39;</span><span class="op">,</span> <span class="st">&#39;B5&#39;</span>])<span class="op">;</span>   </span>
<span id="cb9-2"><a href="spectral-indices-transformations.html#cb9-2"></a><span class="kw">var</span> barePalette <span class="op">=</span>  <span class="va">waterPalette</span>.<span class="at">slice</span>().<span class="at">reverse</span>()<span class="op">;</span>   </span>
<span id="cb9-3"><a href="spectral-indices-transformations.html#cb9-3"></a><span class="va">Map</span>.<span class="at">addLayer</span>(ndbi<span class="op">,</span> <span class="op">{</span><span class="dt">min</span><span class="op">:</span> <span class="dv">-1</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span>  <span class="dt">palette</span><span class="op">:</span> barePalette<span class="op">},</span> <span class="st">&#39;NDBI&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<p>(Check <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">this reference</a> to demystify the palette reversal).</p>
</div>
<div id="burned-area-index-bai" class="section level4">
<h4><span class="header-section-number">3.1.1.6</span> Burned Area Index (BAI)</h4>
<p>The Burned Area Index (BAI) was developed by <a href="http://www.tandfonline.com/doi/abs/10.1080/01431160210153129">Chuvieco et al.¬†(2002)</a> to assist in the delineation of burn scars and assessment of burn severity. It is based on the spectral distance to charcoal reflectance. To examine burn indices, load an image from 2013 showing the <a href="https://en.wikipedia.org/wiki/Rim_Fire">Rim fire</a> in the Sierra Nevadas:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb10-1"><a href="spectral-indices-transformations.html#cb10-1"></a><span class="kw">var</span> burnImage <span class="op">=</span> <span class="va">ee</span>.<span class="at">Image</span>(landsat8                         </span>
<span id="cb10-2"><a href="spectral-indices-transformations.html#cb10-2"></a>                         .<span class="at">filterBounds</span>(<span class="va">ee</span>.<span class="va">Geometry</span>.<span class="at">Point</span>(<span class="op">-</span><span class="fl">120.083</span><span class="op">,</span> <span class="fl">37.850</span>))                                        </span>
<span id="cb10-3"><a href="spectral-indices-transformations.html#cb10-3"></a>                         .<span class="at">filterDate</span>(<span class="st">&#39;2013-08-17&#39;</span><span class="op">,</span> <span class="st">&#39;2013-09-27&#39;</span>)                         </span>
<span id="cb10-4"><a href="spectral-indices-transformations.html#cb10-4"></a>                         .<span class="at">sort</span>(<span class="st">&#39;CLOUD_COVER&#39;</span>)                         </span>
<span id="cb10-5"><a href="spectral-indices-transformations.html#cb10-5"></a>                         .<span class="at">first</span>())<span class="op">;</span><span class="va">Map</span>.<span class="at">addLayer</span>(burnImage<span class="op">,</span> trueColor<span class="op">,</span> <span class="st">&#39;burn image&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<p>Closely examine the true color display of this image. Can you spot the fire? If not, the BAI may help. As with EVI, use an expression to compute BAI in Earth Engine:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb11-1"><a href="spectral-indices-transformations.html#cb11-1"></a><span class="kw">var</span> exp <span class="op">=</span> <span class="st">&#39;1.0  / ((0.1 - RED)**2 + (0.06 - NIR)**2)&#39;</span><span class="op">;</span></span>
<span id="cb11-2"><a href="spectral-indices-transformations.html#cb11-2"></a><span class="kw">var</span> bai <span class="op">=</span> <span class="va">burnImage</span>.<span class="at">expression</span>(  exp<span class="op">,</span>   </span>
<span id="cb11-3"><a href="spectral-indices-transformations.html#cb11-3"></a>                               <span class="op">{</span><span class="st">&#39;NIR&#39;</span><span class="op">:</span> <span class="va">burnImage</span>.<span class="at">select</span>(<span class="st">&#39;B5&#39;</span>)<span class="op">,</span>   </span>
<span id="cb11-4"><a href="spectral-indices-transformations.html#cb11-4"></a>                                <span class="st">&#39;RED&#39;</span><span class="op">:</span> <span class="va">burnImage</span>.<span class="at">select</span>(<span class="st">&#39;B4&#39;</span>) </span>
<span id="cb11-5"><a href="spectral-indices-transformations.html#cb11-5"></a>                               <span class="op">}</span></span>
<span id="cb11-6"><a href="spectral-indices-transformations.html#cb11-6"></a>                              )<span class="op">;</span>  </span></code></pre></div>
<p>Display the result.</p>
<!-- The burn area should be more obvious in the BAI visualization. -->
<div class="sourceCode" id="cb12"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb12-1"><a href="spectral-indices-transformations.html#cb12-1"></a><span class="kw">var</span> burnPalette <span class="op">=</span> [<span class="st">&#39;green&#39;</span><span class="op">,</span> <span class="st">&#39;blue&#39;</span><span class="op">,</span> <span class="st">&#39;yellow&#39;</span><span class="op">,</span> <span class="st">&#39;red&#39;</span>]<span class="op">;</span>   </span>
<span id="cb12-2"><a href="spectral-indices-transformations.html#cb12-2"></a><span class="va">Map</span>.<span class="at">addLayer</span>(bai<span class="op">,</span> <span class="op">{</span><span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">400</span><span class="op">,</span>  <span class="dt">palette</span><span class="op">:</span> burnPalette<span class="op">},</span> <span class="st">&#39;BAI&#39;</span>)<span class="op">;</span></span></code></pre></div>
<hr />
<p><i class="fa fa-file"></i> <strong>2c. Compare NDBI and the BAI displayed results ‚Äì what do you observe?</strong></p>
<hr />
</div>
<div id="normalized-burn-ratio-thermal-nbrt" class="section level4">
<h4><span class="header-section-number">3.1.1.7</span> Normalized Burn Ratio Thermal (NBRT)</h4>
<p>The Normalized Burn Ratio Thermal (NBRT) was developed based on the idea that burned land has low NIR reflectance (less vegetation), high SWIR reflectance (think ash), and high brightness temperature (<a href="http://www.tandfonline.com/doi/abs/10.1080/01431160500239008">Holden et al.¬†2005</a>). Unlike the other indices, a lower NBRT means more burning. Implement the NBRT with an expression</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb13-1"><a href="spectral-indices-transformations.html#cb13-1"></a><span class="kw">var</span> exp <span class="op">=</span> <span class="st">&#39;(NIR - 0.0001 * SWIR *  Temp) / (NIR + 0.0001 * SWIR * Temp)&#39;</span></span>
<span id="cb13-2"><a href="spectral-indices-transformations.html#cb13-2"></a><span class="kw">var</span> nbrt <span class="op">=</span> <span class="va">burnImage</span>.<span class="at">expression</span>(exp<span class="op">,</span>   </span>
<span id="cb13-3"><a href="spectral-indices-transformations.html#cb13-3"></a>                                <span class="op">{</span><span class="st">&#39;NIR&#39;</span><span class="op">:</span> <span class="va">burnImage</span>.<span class="at">select</span>(<span class="st">&#39;B5&#39;</span>)<span class="op">,</span>   </span>
<span id="cb13-4"><a href="spectral-indices-transformations.html#cb13-4"></a>                                 <span class="st">&#39;SWIR&#39;</span><span class="op">:</span> <span class="va">burnImage</span>.<span class="at">select</span>(<span class="st">&#39;B7&#39;</span>)<span class="op">,</span>   </span>
<span id="cb13-5"><a href="spectral-indices-transformations.html#cb13-5"></a>                                 <span class="st">&#39;Temp&#39;</span><span class="op">:</span> <span class="va">burnImage</span>.<span class="at">select</span>(<span class="st">&#39;B11&#39;</span>)  </span>
<span id="cb13-6"><a href="spectral-indices-transformations.html#cb13-6"></a>                                <span class="op">}</span>)<span class="op">;</span>  </span></code></pre></div>
<p>To display this result, reverse the scale:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb14-1"><a href="spectral-indices-transformations.html#cb14-1"></a>  <span class="va">Map</span>.<span class="at">addLayer</span>(nbrt<span class="op">,</span> <span class="op">{</span><span class="dt">min</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">0.9</span><span class="op">,</span>  <span class="dt">palette</span><span class="op">:</span> burnPalette<span class="op">},</span> <span class="st">&#39;NBRT&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<p>The difference in this index, before - after the fire, can be used as a diagnostic of burn severity (see <a href="http://www.sciencedirect.com/science/article/pii/S003442570400152X">van Wagtendonk et al.¬†2004</a>).</p>
</div>
<div id="normalized-difference-snow-index-ndsi" class="section level4">
<h4><span class="header-section-number">3.1.1.8</span> Normalized Difference Snow Index (NDSI)</h4>
<p>The Normalized Difference Snow Index (NDSI) was designed to estimate the amount of a pixel covered in snow (<a href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=399618&amp;tag=1">Riggs et al.¬†1994</a>)</p>
<p><span class="math display">\[\text{NDSI} = (\text{green} - \text{SWIR}) /(\text{green} + \text{SWIR})\]</span></p>
<p>First, find a snow covered scene to test the index:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb15-1"><a href="spectral-indices-transformations.html#cb15-1"></a><span class="kw">var</span> snowImage <span class="op">=</span> <span class="va">ee</span>.<span class="at">Image</span>(landsat8 </span>
<span id="cb15-2"><a href="spectral-indices-transformations.html#cb15-2"></a>                         .<span class="at">filterBounds</span>(<span class="va">ee</span>.<span class="va">Geometry</span>.<span class="at">Point</span>(<span class="op">-</span><span class="fl">120.0421</span><span class="op">,</span> <span class="fl">39.1002</span>))  </span>
<span id="cb15-3"><a href="spectral-indices-transformations.html#cb15-3"></a>                         .<span class="at">filterDate</span>(<span class="st">&#39;2013-11-01&#39;</span><span class="op">,</span> <span class="st">&#39;2014-05-01&#39;</span>)                         </span>
<span id="cb15-4"><a href="spectral-indices-transformations.html#cb15-4"></a>                         .<span class="at">sort</span>(<span class="st">&#39;CLOUD_COVER&#39;</span>)                         </span>
<span id="cb15-5"><a href="spectral-indices-transformations.html#cb15-5"></a>                         .<span class="at">first</span>())<span class="op">;</span></span>
<span id="cb15-6"><a href="spectral-indices-transformations.html#cb15-6"></a><span class="va">Map</span>.<span class="at">addLayer</span>(snowImage<span class="op">,</span> trueColor<span class="op">,</span> <span class="st">&#39;snow image&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<p>Compute and display NDSI in Earth Engine:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb16-1"><a href="spectral-indices-transformations.html#cb16-1"></a><span class="kw">var</span> ndsi <span class="op">=</span> <span class="va">snowImage</span>.<span class="at">normalizedDifference</span>([<span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B6&#39;</span>])<span class="op">;</span>      </span>
<span id="cb16-2"><a href="spectral-indices-transformations.html#cb16-2"></a><span class="kw">var</span> snowPalette <span class="op">=</span> [<span class="st">&#39;red&#39;</span><span class="op">,</span> <span class="st">&#39;green&#39;</span><span class="op">,</span> <span class="st">&#39;blue&#39;</span><span class="op">,</span> <span class="st">&#39;white&#39;</span>]<span class="op">;</span>   </span>
<span id="cb16-3"><a href="spectral-indices-transformations.html#cb16-3"></a><span class="va">Map</span>.<span class="at">addLayer</span>(ndsi<span class="op">,</span>              </span>
<span id="cb16-4"><a href="spectral-indices-transformations.html#cb16-4"></a>             <span class="op">{</span><span class="dt">min</span><span class="op">:</span> <span class="fl">-0.5</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span>  <span class="dt">palette</span><span class="op">:</span> snowPalette<span class="op">},</span>              </span>
<span id="cb16-5"><a href="spectral-indices-transformations.html#cb16-5"></a>             <span class="st">&#39;NDSI&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
</div>
</div>
<div id="linear-transformations" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Linear Transformations</h3>
<p>Linear transforms are linear combinations of input pixel values. These can result from a variety of different strategies, but a common theme is that pixels are treated as arrays of band values.</p>
<div id="tasseled-cap-tc" class="section level4">
<h4><span class="header-section-number">3.1.2.1</span> Tasseled cap (TC)</h4>
<p>Based on observations of agricultural land covers in the NIR-red spectral space, <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.461.6381&amp;rep=rep1&amp;type=pdf">Kauth and Thomas (1976)</a> devised a <a href="https://en.wikipedia.org/wiki/Change_of_basis">rotational transform</a> of the form</p>
<!-- **p**1 = **R**T**p**0 -->
<p><span class="math display">\[p_1 = R^T p_0 \]</span></p>
<p>where <strong>p_0</strong> is the original <em>p</em>x1 pixel vector (a stack of the <em>p</em> band values as an <a href="https://developers.google.com/earth-engine/arrays_intro">Array</a>), <strong>p_1</strong> is the rotated pixel and <strong>R</strong> is an <a href="https://en.wikipedia.org/wiki/Orthonormal_basis">orthonormal basis</a> of the new space (therefore <strong>R^T</strong> is its inverse). Kauth and Thomas found <strong>R</strong> by defining the first axis of their transformed space to be parallel to the soil line in the following chart, then used the <a href="https://en.wikipedia.org/wiki/Gram‚ÄìSchmidt_process">Gram-Schmidt process</a> to find the other basis vectors.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tasselcap"></span>
<img src="tassel_cap_lab3.png" alt="Tassel Cap Illustration" width="95%" />
<p class="caption">
Figure 3.2: Tassel Cap Illustration
</p>
</div>
<p>Assuming that <strong>R</strong> is available, one way to implement this rotation in Earth Engine is with arrays. Specifically, make an array of TC coefficients:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb17-1"><a href="spectral-indices-transformations.html#cb17-1"></a><span class="kw">var</span> coefficients <span class="op">=</span> <span class="va">ee</span>.<span class="at">Array</span>([    </span>
<span id="cb17-2"><a href="spectral-indices-transformations.html#cb17-2"></a>  [<span class="fl">0.3037</span><span class="op">,</span> <span class="fl">0.2793</span><span class="op">,</span> <span class="fl">0.4743</span><span class="op">,</span> <span class="fl">0.5585</span><span class="op">,</span> <span class="fl">0.5082</span><span class="op">,</span> <span class="fl">0.1863</span>]<span class="op">,</span>    </span>
<span id="cb17-3"><a href="spectral-indices-transformations.html#cb17-3"></a>  [<span class="op">-</span><span class="fl">0.2848</span><span class="op">,</span> <span class="fl">-0.2435</span><span class="op">,</span> <span class="fl">-0.5436</span><span class="op">,</span> <span class="fl">0.7243</span><span class="op">,</span> <span class="fl">0.0840</span><span class="op">,</span> <span class="fl">-0.1800</span>]<span class="op">,</span></span>
<span id="cb17-4"><a href="spectral-indices-transformations.html#cb17-4"></a>  [<span class="fl">0.1509</span><span class="op">,</span> <span class="fl">0.1973</span><span class="op">,</span> <span class="fl">0.3279</span><span class="op">,</span> <span class="fl">0.3406</span><span class="op">,</span> <span class="fl">-0.7112</span><span class="op">,</span> <span class="fl">-0.4572</span>]<span class="op">,</span></span>
<span id="cb17-5"><a href="spectral-indices-transformations.html#cb17-5"></a>  [<span class="op">-</span><span class="fl">0.8242</span><span class="op">,</span> <span class="fl">0.0849</span><span class="op">,</span> <span class="fl">0.4392</span><span class="op">,</span> <span class="fl">-0.0580</span><span class="op">,</span> <span class="fl">0.2012</span><span class="op">,</span> <span class="fl">-0.2768</span>]<span class="op">,</span></span>
<span id="cb17-6"><a href="spectral-indices-transformations.html#cb17-6"></a>  [<span class="op">-</span><span class="fl">0.3280</span><span class="op">,</span> <span class="fl">0.0549</span><span class="op">,</span> <span class="fl">0.1075</span><span class="op">,</span> <span class="fl">0.1855</span><span class="op">,</span> <span class="fl">-0.4357</span><span class="op">,</span> <span class="fl">0.8085</span>]<span class="op">,</span></span>
<span id="cb17-7"><a href="spectral-indices-transformations.html#cb17-7"></a>  [<span class="fl">0.1084</span><span class="op">,</span> <span class="fl">-0.9022</span><span class="op">,</span> <span class="fl">0.4120</span><span class="op">,</span> <span class="fl">0.0573</span><span class="op">,</span> <span class="fl">-0.0251</span><span class="op">,</span> <span class="fl">0.0238</span>]</span>
<span id="cb17-8"><a href="spectral-indices-transformations.html#cb17-8"></a>])<span class="op">;</span>  </span></code></pre></div>
<p>Since these coefficients are for the TM sensor, get a less cloudy Landsat 5 scene. First, search for landsat 5 toa‚Äô, then import ‚ÄòUSGS Landsat 5 TOA Reflectance (Orthorectified)‚Äô. Name the import <code>landsat5</code>, then filter and sort the collection as follows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb18-1"><a href="spectral-indices-transformations.html#cb18-1"></a><span class="kw">var</span> tcImage <span class="op">=</span> <span class="va">ee</span>.<span class="at">Image</span>(landsat5</span>
<span id="cb18-2"><a href="spectral-indices-transformations.html#cb18-2"></a>                       .<span class="at">filterBounds</span>(point)</span>
<span id="cb18-3"><a href="spectral-indices-transformations.html#cb18-3"></a>                       .<span class="at">filterDate</span>(<span class="st">&#39;2008-06-01&#39;</span><span class="op">,</span> <span class="st">&#39;2008-09-01&#39;</span>)</span>
<span id="cb18-4"><a href="spectral-indices-transformations.html#cb18-4"></a>                       .<span class="at">sort</span>(<span class="st">&#39;CLOUD_COVER&#39;</span>)</span>
<span id="cb18-5"><a href="spectral-indices-transformations.html#cb18-5"></a>                       .<span class="at">first</span>())<span class="op">;</span>  </span></code></pre></div>
<p>To do the matrix multiplication, first convert the input image from a multi-band image to an array image in which each pixel stores an array:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb19-1"><a href="spectral-indices-transformations.html#cb19-1"></a><span class="kw">var</span> bands <span class="op">=</span> [<span class="st">&#39;B1&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B5&#39;</span><span class="op">,</span> <span class="st">&#39;B7&#39;</span>]<span class="op">;</span></span>
<span id="cb19-2"><a href="spectral-indices-transformations.html#cb19-2"></a><span class="co">// Make an Array Image,  with a 1-D Array per pixel.</span></span>
<span id="cb19-3"><a href="spectral-indices-transformations.html#cb19-3"></a><span class="kw">var</span> arrayImage1D <span class="op">=</span>  <span class="va">tcImage</span>.<span class="at">select</span>(bands).<span class="at">toArray</span>()<span class="op">;</span></span>
<span id="cb19-4"><a href="spectral-indices-transformations.html#cb19-4"></a><span class="co">// Make an Array Image  with a 2-D Array per pixel, 6x1.</span></span>
<span id="cb19-5"><a href="spectral-indices-transformations.html#cb19-5"></a><span class="kw">var</span> arrayImage2D <span class="op">=</span> <span class="va">arrayImage1D</span>.<span class="at">toArray</span>(<span class="dv">1</span>)<span class="op">;</span>  </span></code></pre></div>
<p>Do the matrix multiplication, then convert back to a multi-band image:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb20-1"><a href="spectral-indices-transformations.html#cb20-1"></a><span class="kw">var</span> componentsImage <span class="op">=</span> <span class="va">ee</span>.<span class="at">Image</span>(coefficients)</span>
<span id="cb20-2"><a href="spectral-indices-transformations.html#cb20-2"></a>                .<span class="at">matrixMultiply</span>(arrayImage2D)</span>
<span id="cb20-3"><a href="spectral-indices-transformations.html#cb20-3"></a><span class="co">// Get rid of the extra  dimensions.</span></span>
<span id="cb20-4"><a href="spectral-indices-transformations.html#cb20-4"></a>                .<span class="at">arrayProject</span>([<span class="dv">0</span>])  </span>
<span id="cb20-5"><a href="spectral-indices-transformations.html#cb20-5"></a><span class="co">// Get a multi-band image  with TC-named bands.  </span></span>
<span id="cb20-6"><a href="spectral-indices-transformations.html#cb20-6"></a>                .<span class="at">arrayFlatten</span>(</span>
<span id="cb20-7"><a href="spectral-indices-transformations.html#cb20-7"></a>          [[<span class="st">&#39;brightness&#39;</span><span class="op">,</span> <span class="st">&#39;greenness&#39;</span><span class="op">,</span> <span class="st">&#39;wetness&#39;</span><span class="op">,</span> <span class="st">&#39;fourth&#39;</span><span class="op">,</span> <span class="st">&#39;fifth&#39;</span><span class="op">,</span> <span class="st">&#39;sixth&#39;</span>]]</span>
<span id="cb20-8"><a href="spectral-indices-transformations.html#cb20-8"></a>        )<span class="op">;</span>  </span></code></pre></div>
<p>Finally, display the result:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb21-1"><a href="spectral-indices-transformations.html#cb21-1"></a><span class="kw">var</span> vizParams <span class="op">=</span> <span class="op">{</span></span>
<span id="cb21-2"><a href="spectral-indices-transformations.html#cb21-2"></a>  <span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;brightness&#39;</span><span class="op">,</span> <span class="st">&#39;greenness&#39;</span><span class="op">,</span> <span class="st">&#39;wetness&#39;</span>]<span class="op">,</span></span>
<span id="cb21-3"><a href="spectral-indices-transformations.html#cb21-3"></a>  <span class="dt">min</span><span class="op">:</span> <span class="fl">-0.1</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> [<span class="fl">0.5</span><span class="op">,</span>  <span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.1</span>]</span>
<span id="cb21-4"><a href="spectral-indices-transformations.html#cb21-4"></a><span class="op">};</span></span>
<span id="cb21-5"><a href="spectral-indices-transformations.html#cb21-5"></a><span class="va">Map</span>.<span class="at">addLayer</span>(componentsImage<span class="op">,</span> vizParams<span class="op">,</span> <span class="st">&#39;TC components&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<hr />
<p><i class="fa fa-file"></i> <strong>3a. Upload the resulting <code>componentsImage</code> and interpret your output.</strong></p>
<hr />
</div>
<div id="principal-component-analysis-pca" class="section level4">
<h4><span class="header-section-number">3.1.2.2</span> Principal Component Analysis (PCA)</h4>
<p>Like the TC transform, the <a href="https://en.wikipedia.org/wiki/Principal_component_analysis">PCA transform</a> is a rotational transform in which the new basis is orthonormal, but the axes are determined from statistics of the input image, rather than empirical data. Specifically, the new basis is the <a href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors">eigenvectors</a> of the image‚Äôs <a href="https://en.wikipedia.org/wiki/Covariance_matrix">variance-covariance matrix</a>. As a result, the PCs are uncorrelated. To demonstrate, use the Landsat 8 image, converted to an array image:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb22-1"><a href="spectral-indices-transformations.html#cb22-1"></a><span class="kw">var</span> bands <span class="op">=</span> [<span class="st">&#39;B2&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B5&#39;</span><span class="op">,</span> <span class="st">&#39;B6&#39;</span><span class="op">,</span> <span class="st">&#39;B7&#39;</span><span class="op">,</span> <span class="st">&#39;B10&#39;</span><span class="op">,</span> <span class="st">&#39;B11&#39;</span>]<span class="op">;</span></span>
<span id="cb22-2"><a href="spectral-indices-transformations.html#cb22-2"></a><span class="kw">var</span> arrayImage <span class="op">=</span>  <span class="va">image</span>.<span class="at">select</span>(bands).<span class="at">toArray</span>()<span class="op">;</span>  </span></code></pre></div>
<p>In the next step, use the <a href="https://developers.google.com/earth-engine/reducers_reduce_region">reduceRegion() method</a> to compute statistics (band covariances) for the image. (Here the region is just the image footprint):</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb23-1"><a href="spectral-indices-transformations.html#cb23-1"></a><span class="kw">var</span> covar <span class="op">=</span> <span class="va">arrayImage</span>.<span class="at">reduceRegion</span>(<span class="op">{</span></span>
<span id="cb23-2"><a href="spectral-indices-transformations.html#cb23-2"></a>  <span class="dt">reducer</span><span class="op">:</span> <span class="va">ee</span>.<span class="va">Reducer</span>.<span class="at">covariance</span>()<span class="op">,</span></span>
<span id="cb23-3"><a href="spectral-indices-transformations.html#cb23-3"></a>  <span class="dt">maxPixels</span><span class="op">:</span> <span class="fl">1e9</span></span>
<span id="cb23-4"><a href="spectral-indices-transformations.html#cb23-4"></a><span class="op">}</span>)<span class="op">;</span></span>
<span id="cb23-5"><a href="spectral-indices-transformations.html#cb23-5"></a><span class="kw">var</span> covarArray <span class="op">=</span> <span class="va">ee</span>.<span class="at">Array</span>(<span class="va">covar</span>.<span class="at">get</span>(<span class="st">&#39;array&#39;</span>))<span class="op">;</span>  </span></code></pre></div>
<p>A <a href="https://developers.google.com/earth-engine/reducers_intro"><em>reducer</em></a> is an object that tells Earth Engine what statistic to compute. Note that the result of the reduction is an object with one property, array, that stores the covariance matrix. The next step is to compute the eigenvectors and eigenvalues of that covariance matrix:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb24-1"><a href="spectral-indices-transformations.html#cb24-1"></a><span class="kw">var</span> eigens <span class="op">=</span> <span class="va">covarArray</span>.<span class="at">eigen</span>()<span class="op">;</span>  </span></code></pre></div>
<p>Since the eigenvalues are appended to the eigenvectors, slice the two apart and discard the eigenvectors</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb25-1"><a href="spectral-indices-transformations.html#cb25-1"></a><span class="kw">var</span> eigenVectors <span class="op">=</span> <span class="va">eigens</span>.<span class="at">slice</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span>  </span></code></pre></div>
<p>Perform the matrix multiplication, as with the TC components:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb26-1"><a href="spectral-indices-transformations.html#cb26-1"></a><span class="kw">var</span> principalComponents <span class="op">=</span>  <span class="va">ee</span>.<span class="at">Image</span>(eigenVectors).<span class="at">matrixMultiply</span>(<span class="va">arrayImage</span>.<span class="at">toArray</span>(<span class="dv">1</span>))<span class="op">;</span>  </span></code></pre></div>
<p>Finally, convert back to a multi-band image and display the first PC:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb27-1"><a href="spectral-indices-transformations.html#cb27-1"></a><span class="kw">var</span> pcImage <span class="op">=</span> principalComponents    </span>
<span id="cb27-2"><a href="spectral-indices-transformations.html#cb27-2"></a><span class="co">// Throw out an an  unneeded dimension, [[]] -&gt; [].    </span></span>
<span id="cb27-3"><a href="spectral-indices-transformations.html#cb27-3"></a>                .<span class="at">arrayProject</span>([<span class="dv">0</span>])    </span>
<span id="cb27-4"><a href="spectral-indices-transformations.html#cb27-4"></a><span class="co">// Make the one band  array image a multi-band image, [] -&gt; image.    </span></span>
<span id="cb27-5"><a href="spectral-indices-transformations.html#cb27-5"></a>                .<span class="at">arrayFlatten</span>(</span>
<span id="cb27-6"><a href="spectral-indices-transformations.html#cb27-6"></a>          [[<span class="st">&#39;pc1&#39;</span><span class="op">,</span> <span class="st">&#39;pc2&#39;</span><span class="op">,</span> <span class="st">&#39;pc3&#39;</span><span class="op">,</span> <span class="st">&#39;pc4&#39;</span><span class="op">,</span> <span class="st">&#39;pc5&#39;</span><span class="op">,</span> <span class="st">&#39;pc6&#39;</span><span class="op">,</span> <span class="st">&#39;pc7&#39;</span><span class="op">,</span> <span class="st">&#39;pc8&#39;</span>]]</span>
<span id="cb27-7"><a href="spectral-indices-transformations.html#cb27-7"></a>        )<span class="op">;</span>      </span>
<span id="cb27-8"><a href="spectral-indices-transformations.html#cb27-8"></a><span class="va">Map</span>.<span class="at">addLayer</span>(<span class="va">pcImage</span>.<span class="at">select</span>(<span class="st">&#39;pc1&#39;</span>)<span class="op">,</span> <span class="op">{},</span> <span class="st">&#39;PC&#39;</span>)<span class="op">;</span>   </span></code></pre></div>
<p>Use the <a href="https://developers.google.com/earth-engine/playground#layer-manager">layer manager</a> to stretch the result. What do you observe? Try displaying some of the other principal components.</p>
<hr />
<p><i class="fa fa-file"></i> <strong>3b. How much did you need to stretch the results to display outputs for principal component 1? Display and upload images of each the other principal components, stretching each band as needed for visual interpretation and indicating how you selected each stretch. How do you interpret each PC band? On what basis do you make that interpretation? </strong></p>
<hr />
</div>
<div id="spectral-unmixing" class="section level4">
<h4><span class="header-section-number">3.1.2.3</span> Spectral Unmixing</h4>
<p>The <a href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=974727&amp;tag=1">linear spectral mixing model</a> is based on the assumption that each pixel is a mixture of ‚Äúpure‚Äù spectra. The pure spectra, called <em>endmembers</em>, are from land cover classes such as water, bare land, vegetation. The goal is to solve the following equation for <strong>f</strong>, the <em>P</em>x1 vector of endmember fractions in the pixel:</p>
<p><span class="math display">\[ Sf = p \]</span></p>
<p>where <strong>S</strong> is a <em>B</em>x<em>P</em> matrix in which the columns are <em>P</em> pure endmember spectra (known) and <strong>p</strong> is the <em>B</em>x1 pixel vector when there are <em>B</em> bands (known). In this example, <span class="math inline">\(B= 6\)</span>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb28-1"><a href="spectral-indices-transformations.html#cb28-1"></a><span class="kw">var</span> unmixImage <span class="op">=</span> <span class="va">image</span>.<span class="at">select</span>([<span class="st">&#39;B2&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B5&#39;</span><span class="op">,</span> <span class="st">&#39;B6&#39;</span><span class="op">,</span> <span class="st">&#39;B7&#39;</span>])<span class="op">;</span>  </span></code></pre></div>
<p>The first step is to get the endmember spectra. Do that by computing the mean spectra in polygons delineated around regions of pure land cover. Zoom the map to a location with homogeneous areas of bare land, vegetation and water (hint: SFO). Visualize the input as a false color composite.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb29-1"><a href="spectral-indices-transformations.html#cb29-1"></a><span class="va">Map</span>.<span class="at">addLayer</span>(image<span class="op">,</span> <span class="op">{</span><span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B5&#39;</span><span class="op">,</span> <span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span>]<span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">},</span> <span class="st">&#39;false color&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<p>Using the <a href="https://developers.google.com/earth-engine/playground#geometry-tools">geometry drawing tools</a>, make three new layers (<em>P</em>=3) by clicking <strong>+ new layer</strong>. In the first layer, digitize a polygon around pure bare land; in the second layer make a polygon of pure vegetation; in the third layer, make a water polygon. Name the imports bare, veg, and water, respectively. Check the polygons you made by charting mean spectra in them using <a href="https://developers.google.com/earth-engine/charts_image_regions">Chart.image.regions()</a>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb30-1"><a href="spectral-indices-transformations.html#cb30-1"></a><span class="at">print</span>(<span class="va">Chart</span>.<span class="va">image</span>.<span class="at">regions</span>(unmixImage<span class="op">,</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>([</span>
<span id="cb30-2"><a href="spectral-indices-transformations.html#cb30-2"></a>    <span class="va">ee</span>.<span class="at">Feature</span>(bare<span class="op">,</span> <span class="op">{</span><span class="dt">label</span><span class="op">:</span> <span class="st">&#39;bare&#39;</span><span class="op">}</span>)<span class="op">,</span> </span>
<span id="cb30-3"><a href="spectral-indices-transformations.html#cb30-3"></a>    <span class="va">ee</span>.<span class="at">Feature</span>(water<span class="op">,</span> <span class="op">{</span><span class="dt">label</span><span class="op">:</span> <span class="st">&#39;water&#39;</span><span class="op">}</span>)<span class="op">,</span></span>
<span id="cb30-4"><a href="spectral-indices-transformations.html#cb30-4"></a>    <span class="va">ee</span>.<span class="at">Feature</span>(veg<span class="op">,</span> <span class="op">{</span><span class="dt">label</span><span class="op">:</span> <span class="st">&#39;vegetation&#39;</span><span class="op">}</span>)])<span class="op">,</span> </span>
<span id="cb30-5"><a href="spectral-indices-transformations.html#cb30-5"></a>  <span class="va">ee</span>.<span class="va">Reducer</span>.<span class="at">mean</span>()<span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="st">&#39;label&#39;</span><span class="op">,</span> [<span class="fl">0.48</span><span class="op">,</span> <span class="fl">0.56</span><span class="op">,</span> <span class="fl">0.65</span><span class="op">,</span> <span class="fl">0.86</span><span class="op">,</span> <span class="fl">1.61</span><span class="op">,</span> <span class="fl">2.2</span>]))<span class="op">;</span></span></code></pre></div>
<p>Your chart should look something like:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spectralchartlab3"></span>
<img src="spectral_chart_lab3.png" alt="Spectral Chart" width="95%" />
<p class="caption">
Figure 3.3: Spectral Chart
</p>
</div>
<p>Use the <a href="https://developers.google.com/earth-engine/reducers_reduce_region">reduceRegion() method</a> to compute mean spectra in the polygons you made. Note that the return value of reduceRegion() is a Dictionary, with reducer output keyed by band name. Get the means as a List by calling values():</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb31-1"><a href="spectral-indices-transformations.html#cb31-1"></a><span class="kw">var</span> bareMean <span class="op">=</span> <span class="va">unmixImage</span>.<span class="at">reduceRegion</span>(</span>
<span id="cb31-2"><a href="spectral-indices-transformations.html#cb31-2"></a>  <span class="va">ee</span>.<span class="va">Reducer</span>.<span class="at">mean</span>()<span class="op">,</span> bare<span class="op">,</span> <span class="dv">30</span>).<span class="at">values</span>()<span class="op">;</span>   </span>
<span id="cb31-3"><a href="spectral-indices-transformations.html#cb31-3"></a><span class="kw">var</span> waterMean <span class="op">=</span> <span class="va">unmixImage</span>.<span class="at">reduceRegion</span>(</span>
<span id="cb31-4"><a href="spectral-indices-transformations.html#cb31-4"></a>  <span class="va">ee</span>.<span class="va">Reducer</span>.<span class="at">mean</span>()<span class="op">,</span> water<span class="op">,</span> <span class="dv">30</span>).<span class="at">values</span>()<span class="op">;</span>   </span>
<span id="cb31-5"><a href="spectral-indices-transformations.html#cb31-5"></a><span class="kw">var</span> vegMean <span class="op">=</span> <span class="va">unmixImage</span>.<span class="at">reduceRegion</span>(</span>
<span id="cb31-6"><a href="spectral-indices-transformations.html#cb31-6"></a>  <span class="va">ee</span>.<span class="va">Reducer</span>.<span class="at">mean</span>()<span class="op">,</span> veg<span class="op">,</span> <span class="dv">30</span>).<span class="at">values</span>()<span class="op">;</span>  </span></code></pre></div>
<p>Each of these three lists represents a mean spectrum vector. Stack the vectors into a 6x3 Array of endmembers by concatenating them along the 1-axis (or columns direction):</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb32-1"><a href="spectral-indices-transformations.html#cb32-1"></a><span class="kw">var</span> endmembers <span class="op">=</span> <span class="va">ee</span>.<span class="va">Array</span>.<span class="at">cat</span>([bareMean<span class="op">,</span>  vegMean<span class="op">,</span> waterMean]<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span>  </span></code></pre></div>
<p>Turn the 6-band input image into an image in which each pixel is a 1D vector (<code>toArray()</code>), then into an image in which each pixel is a 6x1 matrix (<code>toArray(1)</code>):</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb33-1"><a href="spectral-indices-transformations.html#cb33-1"></a><span class="kw">var</span> arrayImage <span class="op">=</span> <span class="va">unmixImage</span>.<span class="at">toArray</span>().<span class="at">toArray</span>(<span class="dv">1</span>)<span class="op">;</span></span></code></pre></div>
<p>Now that the dimensions match, in each pixel, solve the equation for <strong>f</strong>:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb34-1"><a href="spectral-indices-transformations.html#cb34-1"></a><span class="kw">var</span> unmixed <span class="op">=</span>  <span class="va">ee</span>.<span class="at">Image</span>(endmembers).<span class="at">matrixSolve</span>(arrayImage)<span class="op">;</span></span></code></pre></div>
<p>Finally, convert the result from a 2D array image into a 1D array image (<code>arrayProject()</code>), then to a multi-band image (<code>arrayFlatten()</code>). The three bands correspond to the estimates of bare, vegetation and water fractions in <strong>f</strong>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb35-1"><a href="spectral-indices-transformations.html#cb35-1"></a><span class="kw">var</span> unmixedImage <span class="op">=</span> <span class="va">unmixed</span>.<span class="at">arrayProject</span>([<span class="dv">0</span>])</span>
<span id="cb35-2"><a href="spectral-indices-transformations.html#cb35-2"></a>                .<span class="at">arrayFlatten</span>(</span>
<span id="cb35-3"><a href="spectral-indices-transformations.html#cb35-3"></a>          [[<span class="st">&#39;bare&#39;</span><span class="op">,</span> <span class="st">&#39;veg&#39;</span><span class="op">,</span> <span class="st">&#39;water&#39;</span>]]</span>
<span id="cb35-4"><a href="spectral-indices-transformations.html#cb35-4"></a>        )<span class="op">;</span>  </span></code></pre></div>
<p>Display the result where bare is red, vegetation is green, and water is blue (the <code>addLayer()</code> call expects bands in order, RGB)</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb36-1"><a href="spectral-indices-transformations.html#cb36-1"></a><span class="va">Map</span>.<span class="at">addLayer</span>(unmixedImage<span class="op">,</span> <span class="op">{},</span> <span class="st">&#39;Unmixed&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<hr />
<p><i class="fa fa-file"></i> <strong>3c. Upload the mean spectra chart you generated for bare, water, and land. Then upload the resulting map and interpret the output of the <code>unmixedImage</code></strong>.</p>
<hr />
</div>
<div id="hue-saturation-value-transform" class="section level4">
<h4><span class="header-section-number">3.1.2.4</span> Hue-Saturation-Value Transform</h4>
<p>The Hue-Saturation-Value (HSV) model <a href="https://en.wikipedia.org/wiki/HSL_and_HSV">is a color transform of the RGB color space</a>. Among many other things, it is useful for <a href="https://en.wikipedia.org/wiki/Pansharpened_image">pan-sharpening</a>. This involves converting an RGB to HSV, swapping the panchromatic band for the value (V), then converting back to RGB. For example, using the Landsat 8 scene:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb37-1"><a href="spectral-indices-transformations.html#cb37-1"></a><span class="co">//  Convert Landsat RGB bands to HSV   </span></span>
<span id="cb37-2"><a href="spectral-indices-transformations.html#cb37-2"></a><span class="kw">var</span> hsv <span class="op">=</span> <span class="va">image</span>.<span class="at">select</span>([<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]).<span class="at">rgbToHsv</span>()<span class="op">;</span></span>
<span id="cb37-3"><a href="spectral-indices-transformations.html#cb37-3"></a><span class="co">// Convert back to RGB,  swapping the image panchromatic band for the value.</span></span>
<span id="cb37-4"><a href="spectral-indices-transformations.html#cb37-4"></a><span class="kw">var</span> rgb <span class="op">=</span> <span class="va">ee</span>.<span class="va">Image</span>.<span class="at">cat</span>([</span>
<span id="cb37-5"><a href="spectral-indices-transformations.html#cb37-5"></a>  <span class="va">hsv</span>.<span class="at">select</span>(<span class="st">&#39;hue&#39;</span>)<span class="op">,</span></span>
<span id="cb37-6"><a href="spectral-indices-transformations.html#cb37-6"></a>  <span class="va">hsv</span>.<span class="at">select</span>(<span class="st">&#39;saturation&#39;</span>)<span class="op">,</span></span>
<span id="cb37-7"><a href="spectral-indices-transformations.html#cb37-7"></a>  <span class="va">image</span>.<span class="at">select</span>([<span class="st">&#39;B8&#39;</span>])]).<span class="at">hsvToRgb</span>()<span class="op">;</span></span>
<span id="cb37-8"><a href="spectral-indices-transformations.html#cb37-8"></a><span class="va">Map</span>.<span class="at">addLayer</span>(rgb<span class="op">,</span> <span class="op">{</span><span class="dt">max</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">},</span> <span class="st">&#39;Pan-sharpened&#39;</span>)<span class="op">;</span>  </span></code></pre></div>
<hr />
<p><i class="fa fa-file"></i> <strong>3d. Compare the pan-sharpened image with the original image. What do you notice that‚Äôs different? The same? </strong></p>
<hr />
</div>
</div>
</div>
<div id="spectral-transformation" class="section level2">
<h2><span class="header-section-number">3.2</span> Spectral Transformation</h2>
<div id="linear-filtering" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Linear Filtering</h3>
<p>In the present context, linear <em>filtering</em> (or <a href="http://www.dspguide.com/ch24/1.htm">convolution</a>) refers to a linear combination of pixel values in a neighborhood. The neighborhood is specified by a <a href="https://en.wikipedia.org/wiki/Kernel_(image_processing)">kernel</a>, where the weights of the kernel determine the coefficients in the linear combination. (For this lab, the terms <em>kernel</em> and <em>filter</em> are interchangeable.) Filtering an image can be useful for extracting image information at different <a href="http://www.dspguide.com/ch24/5.htm">spatial frequencies</a>. For this reason, smoothing filters are called <em>low-pass</em> filters (they let <em>low</em>-frequency data <em>pass</em> through) and edge detection filters are called <em>high-pass</em> filters. To implement filtering in Earth Engine use <a href="https://developers.google.com/earth-engine/guides/image_convolutions">image.convolve()</a> with an ee.Kernel for the argument.</p>
<div id="smoothing" class="section level4">
<h4><span class="header-section-number">3.2.1.1</span> Smoothing</h4>
<p>Smoothing means to convolve an image with a smoothing kernel.</p>
<ol style="list-style-type: lower-roman">
<li><p>A simple smoothing filter is a square kernel with uniform weights that sum to one. Convolving with this kernel sets each pixel to the mean of its neighborhood. Print a square kernel with uniform weights (this is sometimes called a ‚Äúpillbox‚Äù or ‚Äúboxcar‚Äù filter):</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb38-1"><a href="spectral-indices-transformations.html#cb38-1"></a><span class="co">// Print a uniform kernel to see its weights.</span></span>
<span id="cb38-2"><a href="spectral-indices-transformations.html#cb38-2"></a><span class="at">print</span>(<span class="st">&#39;A uniform kernel:&#39;</span><span class="op">,</span> <span class="va">ee</span>.<span class="va">Kernel</span>.<span class="at">square</span>(<span class="dv">2</span>))<span class="op">;</span></span></code></pre></div>
<p>Expand the kernel object in the console to see the weights. This kernel is defined by how many pixels it covers (i.e.¬†<code>radius</code> is in units of ‚Äòpixels‚Äô). A kernel with radius defined in ‚Äòmeters‚Äô adjusts its size in pixels, so you can‚Äôt visualize its weights, but it‚Äôs more flexible in terms of adapting to inputs of different scale. In the following, use kernels with radius defined in meters except to visualize the weights.</p></li>
<li><p>Define a kernel with 2-meter radius (Which corresponds to how many pixels in the NAIP image? Hint: try <a href="https://developers.google.com/earth-engine/guides/projections">projection.nominalScale()</a>), convolve the image with the kernel and compare the input image with the smoothed image:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb39-1"><a href="spectral-indices-transformations.html#cb39-1"></a><span class="co">// Define a square, uniform kernel.</span></span>
<span id="cb39-2"><a href="spectral-indices-transformations.html#cb39-2"></a><span class="kw">var</span> uniformKernel <span class="op">=</span> <span class="va">ee</span>.<span class="va">Kernel</span>.<span class="at">square</span>(<span class="op">{</span></span>
<span id="cb39-3"><a href="spectral-indices-transformations.html#cb39-3"></a> <span class="dt">radius</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb39-4"><a href="spectral-indices-transformations.html#cb39-4"></a> <span class="dt">units</span><span class="op">:</span> <span class="st">&#39;meters&#39;</span><span class="op">,</span></span>
<span id="cb39-5"><a href="spectral-indices-transformations.html#cb39-5"></a><span class="op">}</span>)<span class="op">;</span></span>
<span id="cb39-6"><a href="spectral-indices-transformations.html#cb39-6"></a><span class="co">// Filter the image by convolving with the smoothing filter.</span></span>
<span id="cb39-7"><a href="spectral-indices-transformations.html#cb39-7"></a><span class="kw">var</span> smoothed <span class="op">=</span> <span class="va">image</span>.<span class="at">convolve</span>(uniformKernel)<span class="op">;</span></span>
<span id="cb39-8"><a href="spectral-indices-transformations.html#cb39-8"></a><span class="va">Map</span>.<span class="at">addLayer</span>(smoothed<span class="op">,</span> <span class="op">{</span><span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">0.35</span><span class="op">},</span> <span class="st">&#39;smoothed image&#39;</span>)<span class="op">;</span></span></code></pre></div></li>
<li><p>To make the image even smoother, try increasing the size of the neighborhood by increasing the pixel radius.</p></li>
<li><p>A Gaussian kernel can also be used for smoothing. Think of filtering with a Gaussian kernel as computing the weighted average in each pixel‚Äôs neighborhood. For example:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb40-1"><a href="spectral-indices-transformations.html#cb40-1"></a><span class="co">// Print a Gaussian kernel to see its weights.</span></span>
<span id="cb40-2"><a href="spectral-indices-transformations.html#cb40-2"></a><span class="at">print</span>(<span class="st">&#39;A Gaussian kernel:&#39;</span><span class="op">,</span> <span class="va">ee</span>.<span class="va">Kernel</span>.<span class="at">gaussian</span>(<span class="dv">2</span>))<span class="op">;</span></span>
<span id="cb40-3"><a href="spectral-indices-transformations.html#cb40-3"></a><span class="co">// Define a square Gaussian kernel:</span></span>
<span id="cb40-4"><a href="spectral-indices-transformations.html#cb40-4"></a><span class="kw">var</span> gaussianKernel <span class="op">=</span> <span class="va">ee</span>.<span class="va">Kernel</span>.<span class="at">gaussian</span>(<span class="op">{</span></span>
<span id="cb40-5"><a href="spectral-indices-transformations.html#cb40-5"></a> <span class="dt">radius</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb40-6"><a href="spectral-indices-transformations.html#cb40-6"></a> <span class="dt">units</span><span class="op">:</span> <span class="st">&#39;meters&#39;</span><span class="op">,</span></span>
<span id="cb40-7"><a href="spectral-indices-transformations.html#cb40-7"></a><span class="op">}</span>)<span class="op">;</span></span>
<span id="cb40-8"><a href="spectral-indices-transformations.html#cb40-8"></a><span class="co">// Filter the image by convolving with the Gaussian filter.</span></span>
<span id="cb40-9"><a href="spectral-indices-transformations.html#cb40-9"></a><span class="kw">var</span> gaussian <span class="op">=</span> <span class="va">image</span>.<span class="at">convolve</span>(gaussianKernel)<span class="op">;</span></span>
<span id="cb40-10"><a href="spectral-indices-transformations.html#cb40-10"></a><span class="va">Map</span>.<span class="at">addLayer</span>(gaussian<span class="op">,</span> <span class="op">{</span><span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">0.25</span><span class="op">},</span> <span class="st">&#39;Gaussian smoothed image&#39;</span>)<span class="op">;</span></span></code></pre></div></li>
</ol>
<hr />
<p><i class="fa fa-file"></i> <strong>4a. What happens as you increase the pixel radius for each smoothing? What differences can you discern between the weights and the visualizations of the two smoothing kernels?</strong></p>
<hr />
</div>
<div id="edge-detection" class="section level4">
<h4><span class="header-section-number">3.2.1.2</span> Edge Detection</h4>
<p>Convolving with an edge-detection kernel is used to find rapid changes in DNs that usually signify edges of objects represented in the image data.</p>
<ol style="list-style-type: lower-roman">
<li><p>A classic edge detection kernel is the <a href="https://en.wikipedia.org/wiki/Discrete_Laplace_operator">Laplacian</a> kernel. Investigate the kernel weights and the image that results from convolving with the Laplacian:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb41-1"><a href="spectral-indices-transformations.html#cb41-1"></a><span class="co">// Define a Laplacian, or edge-detection kernel.</span></span>
<span id="cb41-2"><a href="spectral-indices-transformations.html#cb41-2"></a><span class="kw">var</span> laplacian <span class="op">=</span> <span class="va">ee</span>.<span class="va">Kernel</span>.<span class="at">laplacian8</span>(<span class="op">{</span> <span class="dt">normalize</span><span class="op">:</span> <span class="kw">false</span> <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb41-3"><a href="spectral-indices-transformations.html#cb41-3"></a></span>
<span id="cb41-4"><a href="spectral-indices-transformations.html#cb41-4"></a><span class="co">// Apply the edge-detection kernel.</span></span>
<span id="cb41-5"><a href="spectral-indices-transformations.html#cb41-5"></a><span class="kw">var</span> edgy <span class="op">=</span> <span class="va">image</span>.<span class="at">convolve</span>(laplacian)<span class="op">;</span></span>
<span id="cb41-6"><a href="spectral-indices-transformations.html#cb41-6"></a><span class="va">Map</span>.<span class="at">addLayer</span>(edgy<span class="op">,</span></span>
<span id="cb41-7"><a href="spectral-indices-transformations.html#cb41-7"></a>             <span class="op">{</span><span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B5&#39;</span><span class="op">,</span> <span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span>]<span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> <span class="st">&#39;png&#39;</span><span class="op">},</span></span>
<span id="cb41-8"><a href="spectral-indices-transformations.html#cb41-8"></a>             <span class="st">&#39;edges&#39;</span>)<span class="op">;</span></span></code></pre></div></li>
</ol>
<hr />
<p><i class="fa fa-file"></i> <strong>4b. Upload the image of <code>edgy</code> and describe the output </strong></p>
<hr />
<ol start="2" style="list-style-type: lower-roman">
<li>Other edge detection kernels include the <a href="https://en.wikipedia.org/wiki/Sobel_operator">Sobel</a>, <a href="https://en.wikipedia.org/wiki/Prewitt_operator">Prewitt</a> and <a href="https://en.wikipedia.org/wiki/Roberts_cross">Roberts</a> kernels. <a href="https://developers.google.com/earth-engine/image_edges">Learn more about additional edge detection methods in Earth Engine</a>.</li>
</ol>
</div>
<div id="gradients" class="section level4">
<h4><span class="header-section-number">3.2.1.3</span> Gradients</h4>
<p>An image gradient refers to the change in pixel values over space (analogous to computing slope from a DEM).</p>
<ol style="list-style-type: lower-roman">
<li>Use <a href="https://developers.google.com/earth-engine/guides/image_gradients">image.gradient()</a> to compute the gradient in an image band.</li>
</ol>
<!-- For example, gradients in the NIR band indicate transitions in vegetation: -->
<div class="sourceCode" id="cb42"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb42-1"><a href="spectral-indices-transformations.html#cb42-1"></a>   <span class="co">// Load a Landsat 8 image and select the panchromatic band.</span></span>
<span id="cb42-2"><a href="spectral-indices-transformations.html#cb42-2"></a>  <span class="kw">var</span> Landsat8B8 <span class="op">=</span> <span class="va">ee</span>.<span class="at">Image</span>(<span class="st">&#39;LANDSAT/LC08/C01/T1/LC08_044034_20140318&#39;</span>).<span class="at">select</span>(<span class="st">&#39;B8&#39;</span>)<span class="op">;</span></span>
<span id="cb42-3"><a href="spectral-indices-transformations.html#cb42-3"></a>  </span>
<span id="cb42-4"><a href="spectral-indices-transformations.html#cb42-4"></a>  <span class="kw">var</span> xyGrad <span class="op">=</span> <span class="va">Landsat8B8</span>.<span class="at">gradient</span>()<span class="op">;</span></span>
<span id="cb42-5"><a href="spectral-indices-transformations.html#cb42-5"></a>  </span>
<span id="cb42-6"><a href="spectral-indices-transformations.html#cb42-6"></a>  <span class="co">// Compute the magnitude of the gradient.</span></span>
<span id="cb42-7"><a href="spectral-indices-transformations.html#cb42-7"></a>  <span class="kw">var</span> gradient <span class="op">=</span> <span class="va">xyGrad</span>.<span class="at">select</span>(<span class="st">&#39;x&#39;</span>).<span class="at">pow</span>(<span class="dv">2</span>)</span>
<span id="cb42-8"><a href="spectral-indices-transformations.html#cb42-8"></a>            .<span class="at">add</span>(<span class="va">xyGrad</span>.<span class="at">select</span>(<span class="st">&#39;y&#39;</span>).<span class="at">pow</span>(<span class="dv">2</span>)).<span class="at">sqrt</span>()<span class="op">;</span></span>
<span id="cb42-9"><a href="spectral-indices-transformations.html#cb42-9"></a>  </span>
<span id="cb42-10"><a href="spectral-indices-transformations.html#cb42-10"></a>  <span class="co">// Compute the direction of the gradient.</span></span>
<span id="cb42-11"><a href="spectral-indices-transformations.html#cb42-11"></a>  <span class="kw">var</span> direction <span class="op">=</span> <span class="va">xyGrad</span>.<span class="at">select</span>(<span class="st">&#39;y&#39;</span>).<span class="at">atan2</span>(<span class="va">xyGrad</span>.<span class="at">select</span>(<span class="st">&#39;x&#39;</span>))<span class="op">;</span></span></code></pre></div>
<!-- ii. (Ignore the `reproject()` call for now. It is explained in section 6.) -->
<ol start="2" style="list-style-type: lower-roman">
<li>Gradients in the NIR band indicate transitions in vegetation. For an in-depth study of gradients in multi-spectral imagery, see <a href="http://www.sciencedirect.com/science/article/pii/0734189X86902239">Di Zenzo (1986)</a>.</li>
</ol>
<!-- #### Sharpening -->
<!-- Image sharpening, or [edge enhancement](http://www.dspguide.com/ch24/2.htm), is related to the idea of the image second derivative. Specifically, mimic the perception of [Mach bands](https://en.wikipedia.org/wiki/Mach_bands) in human optical response by adding the image to its second derivative.  -->
<!-- i. One implementation of this idea is to convolve an image with a Laplacian-of-a-Gaussian or [Difference-of-Gaussians](https://en.wikipedia.org/wiki/Difference_of_Gaussians) filter (see [Schowengerdt 2007](http://www.sciencedirect.com/science/book/9780123694072) for details), then add that to the input image:  -->
<!--     ```javascript -->
<!--     // Define a "fat" Gaussian kernel. -->
<!--     var fat = ee.Kernel.gaussian({ -->
<!--                    radius: 3, -->
<!--                sigma: 3, -->
<!--                magnitude: -1, -->
<!--                units: 'meters' -->
<!--     }); -->
<!--     // Define a "skinny" Gaussian kernel. -->
<!--     var skinny = ee.Kernel.gaussian({ -->
<!--                radius: 3, -->
<!--                sigma: 0.5, -->
<!--                units: 'meters' -->
<!--     }); -->
<!--     // Compute a difference-of-Gaussians (DOG) kernel. -->
<!--     var dog = fat.add(skinny); -->
<!--     // Add the DoG filtered image to the original image. -->
<!--     var sharpened = image.add(image.convolve(dog)); -->
<!--     Map.addLayer(sharpened, {min: 0, max: 255}, 'Edges enhanced'); -->
<!--     ``` -->
<!-- ii. Related concepts include [*spectral inversion*](http://www.dspguide.com/ch14/5.htm) from digital signal processing and *unsharp masking* ([Burger and Burge 2008](http://imagingbook.com/)). -->
<!-- ### Non-Linear Filtering -->
<!-- The previous convolution examples can all be implemented as linear combinations of pixel values in a neighborhood (gradient needs a couple extra steps, but nevermind that). Non-linear functions applied to a neighborhood are also useful. Implement these functions in Earth Engine with the [reduceNeighborhood()](https://developers.google.com/earth-engine/guides/reducers_reduce_neighborhood) method on images.  -->
<!--   1. Median -->
<!--   A median filter can be useful for denoising images. Specifically, suppose that random pixels in your image are saturated by anomalously high or low values that result from some noise process. Filtering the image with a mean filter (as in section 3.a.i) would result in pixel values getting polluted by noisy data. To avoid that, smooth the image with a median filter (reusing the 5x5 uniform kernel from above) -->
<!--   ```javascript -->
<!--   var median = image.reduceNeighborhood({ -->
<!--    reducer: ee.Reducer.median(),  -->
<!--    kernel: uniformKernel -->
<!--   }); -->
<!--   Map.addLayer(median, {min: 0, max: 255}, 'Median'); -->
<!--   ``` -->
<!--   2.Mode -->
<!--   For categorical maps, methods such as median and mean make little sense for aggregating nominal data. In these cases, use neighborhood mode to get the most frequently occurring value. -->
<!--   i. For demonstration purposes, make a categorical map by thresholding the NIR band. Two classes, with labels 1 and 0 are the result -->
<!--     ```javascript -->
<!--     // Create and display a simple two-class image. -->
<!--     var veg = image.select('N').gt(200); -->
<!--     // Display the two-class (binary) result. -->
<!--     var binaryVis = {min: 0, max: 1, palette: ['black', 'green']}; -->
<!--     Map.addLayer(veg, binaryVis, 'veg'); -->
<!--     ``` -->
<!-- ii. Compute the mode in each 5x5 neighborhood -->
<!--     ```javascript -->
<!--     // Compute the mode in each 5x5 neighborhood and display the result. -->
<!--     var mode = veg.reduceNeighborhood({ -->
<!--      reducer: ee.Reducer.mode(),  -->
<!--      kernel: uniformKernel -->
<!--     }); -->
<!--     Map.addLayer(mode, binaryVis, 'mode'); -->
<!--     ``` -->
<!-- iii. Compare the shape of patches in the mode image to the original veg image.  -->
<!-- <!-- Note the smoothing effect that the mode has on the shape of patches. -->
<p>‚Äì&gt;</p>
<!-- --- -->
<!-- <i class="fa fa-file"></i> **Upload the two images and compare them. **  -->
<!-- --- -->
<!-- ### Morphological Processing -->
<!-- The idea of morphology is tied to the concept of objects in images. For example, suppose the patches of 1's in the veg image from the previous section represent patches of vegetation. -->
<!-- i. **Dilation (Max).** If the patches underestimate the actual distribution of vegetation, or contain "holes", a max filter can be applied to [dilate](https://en.wikipedia.org/wiki/Dilation_(morphology)) the areas of vegetation -->
<!--     ```javascript -->
<!--     // Dilate by taking the max in each 5x5 neighborhood. -->
<!--     var max = veg.reduceNeighborhood({ -->
<!--      reducer: ee.Reducer.max(),  -->
<!--      kernel: uniformKernel -->
<!--     }); -->
<!--     Map.addLayer(max, binaryVis, 'max'); -->
<!--     ``` -->
<!-- ii. Try increasing the amount of dilation by increasing the size of the kernel (i.e. increase the radius) or applying `reduceNeighborhood()` more than once. -->
<!-- iii. **Erosion (Min)** The opposite of dilation is [erosion](https://en.wikipedia.org/wiki/Erosion_(morphology)), for decreasing the size of the patches -->
<!--     ```javascript -->
<!--     // Erode by taking the min in each 5x5 neighborhood. -->
<!--     var min = veg.reduceNeighborhood({ -->
<!--      reducer: ee.Reducer.min(),  -->
<!--      kernel: uniformKernel -->
<!--     }); -->
<!--     Map.addLayer(min, binaryVis, 'min'); -->
<!--     ``` -->
<!-- iv. Carefully inspect the result compared to the input. Note that the shape of the kernel affects the *shape* of the eroded patches (the same effect occurs in the dilation). Explore this effect by testing different shape kernels. As with the dilation, note that you can get more erosion by increasing the size of the kernel or applying the operation repetitively. -->
<!-- v. **Opening** To "open" possible "holes" in the patches, perform an erosion followed by a dilation. This process is called [opening](https://en.wikipedia.org/wiki/Opening_(morphology)). Try that by performing a dilation of the eroded image: -->
<!--   ```javascript -->
<!--   // Perform an opening by dilating the eroded image. -->
<!--   var opened = min.reduceNeighborhood({ -->
<!--    reducer: ee.Reducer.max(),  -->
<!--    kernel: uniformKernel -->
<!--   }); -->
<!--   Map.addLayer(opened, binaryVis, 'opened'); -->
<!--   ``` -->
<!-- vi. **Closing** The opposite of opening is [closing](https://en.wikipedia.org/wiki/Closing_(morphology)), or dilation followed by erosion. Use this to "close" possible "holes" in the input patches -->
<!--     ```javascript -->
<!--     // Perform a closing by eroding the dilated image. -->
<!--     var closed = max.reduceNeighborhood({ -->
<!--      reducer: ee.Reducer.min(),  -->
<!--      kernel: uniformKernel -->
<!--     }); -->
<!--     Map.addLayer(closed, binaryVis, 'closed'); -->
<!--     ``` -->
<!-- vii. Closely examine the difference between each morphological operation and the veg input. Tune these morphological operators by adjusting the size and shape of the kernel (also called a [*structuring element*](https://en.wikipedia.org/wiki/Structuring_element) in this context, because of its effect on the shape of the result), or applying the operations repeatedly. -->
<!-- ### Texture -->
<!-- Define texture as some measure of DN distribution within a neighborhood. There are a variety of ways to [compute texture in Earth Engine](https://developers.google.com/earth-engine/image_texture). -->
<!-- a. **Standard Deviation (SD)** -->
<!-- The SD measures the spread of the DN distribution in the neighborhood. A textureless neighborhood, in which there is only one DN, has SD=0. Compute neighborhood SD for the NAIP image with: -->
<!-- ```javascript -->
<!-- // Define a big neighborhood with a 7-meter radius kernel. -->
<!-- var bigKernel = ee.Kernel.square({ -->
<!--  radius: 7, -->
<!--  units: 'meters' -->
<!-- }); -->
<!-- // Compute SD in a neighborhood. -->
<!-- var sd = image.reduceNeighborhood({ -->
<!--  reducer: ee.Reducer.stdDev(),  -->
<!--  kernel: bigKernel -->
<!-- }); -->
<!-- Map.addLayer(sd, {min: 0, max: 70}, 'SD'); -->
<!-- ``` -->
<!-- b. **Entropy** -->
<!-- For discrete valued inputs, you can compute [entropy](https://en.wikipedia.org/wiki/Diversity_index#Shannon_index) in a neighborhood, where entropy     in this context is like an index of DN diversity in the neighborhood: -->
<!-- ```javascript -->
<!-- // Compute entropy in a neighborhood. -->
<!-- var entropy = image.entropy(bigKernel); -->
<!-- Map.addLayer(entropy, {min: 1, max: 5}, 'entropy'); -->
<!-- ``` -->
<!-- c. **Gray-level Co-Occurrence Matrices (GLCM)** -->
<!-- The GLCM is computed by forming an *M*x*M* matrix for an image with *M possible DN values, then computing entry *i*,*j* as the frequency at which DN=*i* is adjacent to DN=*j*. A variety of texture metrics can be computed from that matrix, among them is contrast: -->
<!-- ```javascript -->
<!-- // Use the GLCM to compute a large number of texture measures. -->
<!-- var glcmTexture = image.glcmTexture(7); -->
<!-- // Display the 'contrast' results for the red, green and blue bands. -->
<!-- var contrastVis = { -->
<!--  bands: ['R_contrast', 'G_contrast', 'B_contrast'],  -->
<!--  min: 40, -->
<!--  max: 2000 -->
<!-- }; -->
<!-- Map.addLayer(glcmTexture, contrastVis, 'contrast'); -->
<!-- ``` -->
<!-- d. Spatial statistics -->
<!-- Two interesting texture measures from the field of spatial statistics include local [Moran's I](https://en.wikipedia.org/wiki/Moran's_I) and local [Geary's C](https://en.wikipedia.org/wiki/Geary's_C) ([Anselin 1995](http://onlinelibrary.wiley.com/doi/10.1111/j.1538-4632.1995.tb00338.x/abstract)). To compute a local Geary's C with the NAIP image as input, use: -->
<!--   ```javascript -->
<!--   // Create a list of weights for a 9x9 kernel. -->
<!--   var list = [1, 1, 1, 1, 1, 1, 1, 1, 1]; -->
<!--   // The center of the kernel is zero. -->
<!--   var centerList = [1, 1, 1, 1, 0, 1, 1, 1, 1]; -->
<!--   // Assemble a list of lists: the 9x9 kernel weights as a 2-D matrix. -->
<!--   var lists = [list, list, list, list, centerList, list, list, list, list]; -->
<!--   // Create the kernel from the weights. -->
<!--   // Non-zero weights represent the spatial neighborhood. -->
<!--   var kernel = ee.Kernel.fixed(9, 9, lists, -4, -4, false); -->
<!--   // Use the max among bands as the input. -->
<!--   var maxBands = image.reduce(ee.Reducer.max()); -->
<!--   // Convert the neighborhood into multiple bands. -->
<!--   var neighs = maxBands.neighborhoodToBands(kernel); -->
<!--   // Compute local Geary's C, a measure of spatial association. -->
<!--   var gearys = maxBands.subtract(neighs) -->
<!--                .pow(2) -->
<!--                .reduce(ee.Reducer.sum()) -->
<!--                .divide(Math.pow(9, 2)); -->
<!--   Map.addLayer(gearys, {min: 20, max: 2500}, "Geary's C"); -->
<!--   ``` -->
</div>
</div>
</div>
<div id="additional-exercises-2" class="section level2">
<h2><span class="header-section-number">3.3</span> Additional Exercises</h2>
<p><i class="fa fa-file"></i> <strong>5a. Look in google scholar to identify 2-3 publications that have used NDVI and two-three that used EVI. For what purposes were these indices used and what was the justification provided for that index? </strong></p>
<p><i class="fa fa-file"></i> <strong>5b. Discuss a spectral index that we did not cover in this lab relates to your area of research/interest. What is the the name of the spectral index, the formula used to calculate it, and what is it used to detect? Provide a citation of an academic article that has fruitfully used that index. </strong></p>
<p><i class="fa fa-file"></i> <strong>5c. Find 1-2 articles that use any of the linear transformation methods we practiced in this lab in the service of addressing an important social issue (e.g., one related to agriculture, environment, or development). Provide the citations and discussed how the transformation is used and how it‚Äôs justified in the article. </strong></p>
<hr />
</div>
<div id="where-to-submit-2" class="section level2 unnumbered">
<h2>Where to submit</h2>
<p>Submit your responses to these questions on <a href="https://www.gradescope.com/courses/293173/assignments/1446622/submissions">Gradescope</a> by 10am on Wednesday, September 22. If needed, the access code for our course is <code>6PEW3W</code>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lab2.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["labs-rsss.pdf"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
